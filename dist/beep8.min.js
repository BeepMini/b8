function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,c=[],s=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e,t){var r,n,i,o,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return i=!(n=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){i=!0,r=e},f:function(){try{n||null==a.return||a.return()}finally{if(i)throw r}}};if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return a&&(e=a),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _regeneratorRuntime(){_regeneratorRuntime=function(){return a};var l,a={},e=Object.prototype,s=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function u(e,t,r,n){Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(l){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i,o,a,c,t=t&&t.prototype instanceof f?t:f,t=Object.create(t.prototype);return u(t,"_invoke",(i=e,o=r,a=new y(n||[]),c=1,function(e,t){if(3===c)throw Error("Generator is already running");if(4===c){if("throw"===e)throw t;return{value:l,done:!0}}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var n=r.method,i=t.i[n];if(i===l)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=l,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;n=d(i,t.i,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,h;i=n.arg;return i?i.done?(r[t.r]=i.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=l),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}(r,a);if(r){if(r===h)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(1===c)throw c=4,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);c=3;r=d(i,o,a);if("normal"===r.type){if(c=a.done?4:2,r.arg===h)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(c=4,a.method="throw",a.arg=r.arg)}}),!0),t}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=c;var h={};function f(){}function o(){}function g(){}var t={},p=(u(t,n,function(){return this}),Object.getPrototypeOf),p=p&&p(p(b([]))),C=(p&&p!==e&&s.call(p,n)&&(t=p),g.prototype=f.prototype=Object.create(t));function A(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function m(a,c){var t;u(this,"_invoke",function(r,n){function e(){return new c(function(e,t){!function t(e,r,n,i){var o,e=d(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==_typeof(r)&&s.call(r,"__await")?c.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):c.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)});i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()},!0)}function w(e){this.tryEntries.push(e)}function v(e){var t=e[4]||{};t.type="normal",t.arg=l,e[4]=t}function y(e){this.tryEntries=[[-1]],e.forEach(w,this),this.reset(!0)}function b(t){if(null!=t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(s.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=l,e.done=!0,e}).next=e}throw new TypeError(_typeof(t)+" is not iterable")}return u(C,"constructor",o.prototype=g),u(g,"constructor",o),u(g,i,o.displayName="GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,i,"GeneratorFunction")),e.prototype=Object.create(C),e},a.awrap=function(e){return{__await:e}},A(m.prototype),u(m.prototype,r,function(){return this}),a.AsyncIterator=m,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new m(c(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},A(C),u(C,i,"Generator"),u(C,n,function(){return this}),u(C,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.unshift(t);return function e(){for(;n.length;)if((t=n.pop())in r)return e.value=t,e.done=!1,e;return e.done=!0,e}},a.values=b,y.prototype={constructor:y,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(v),!e)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=l)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function e(e){o.type="throw",o.arg=t,r.next=e}for(var n=r.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n],o=i[4],a=this.prev,c=i[1],s=i[2];if(-1===i[0])return e("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=a){if(a<c)return this.method="next",this.arg=l,e(c),!0;if(a<s)return e(s),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(-1<n[0]&&n[0]<=this.prev&&this.prev<n[2]){var i=n;break}}var o=(i=i&&("break"===e||"continue"===e)&&i[0]<=t&&t<=i[2]?null:i)?i[4]:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i[2],h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),v(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i[0]===e)return"throw"===(r=i[4]).type&&(n=r.arg,v(i)),n}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={i:b(e),r:t,n:r},"next"===this.method&&(this.arg=l),h}},a}function asyncGeneratorStep(e,t,r,n,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,i)}function _asyncToGenerator(c){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=c.apply(e,a);function i(e){asyncGeneratorStep(n,t,r,i,o,"next",e)}function o(e){asyncGeneratorStep(n,t,r,i,o,"throw",e)}i(void 0)})}}function _readOnlyError(e){throw new TypeError('"'+e+'" is read-only')}var beep8={};(beep8||_readOnlyError("beep8")).CONFIG={DEBUG:!0,NAME:"beep8 Project",VERSION:"1.0.0-dev",CANVAS_SETTINGS:{CANVAS_ID:"beep8-canvas",CANVAS_CLASSES:[],CONTAINER:null},SFX:{TYPING:"ui/click/003",MENU_UP:"tone/beep/002",MENU_DOWN:"tone/beep/001",MENU_SELECT:"tone/beep/003"},FONT_DEFAULT:"../assets/font-default-thin.png",FONT_TILES:"../assets/font-tiles.png",FONT_ACTORS:"../assets/font-actors.png",CHRS:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*+=-<>_#&@%^~$£€¥¢!?:;'\"/\\()[]{}.,©®™•…| ",CHR_WIDTH:12,CHR_HEIGHT:12,SCREEN_ROWS:25,SCREEN_COLS:20,SCREEN_COLORS:1,CRT_ENABLE:.3,CRT_VIGNETTE:!0,COLORS:["#0A0C1F","#263264","#A0ABB6","#B2EFEB","#3FB0F1","#3548A3","#420241","#6A3E49","#C22D44","#E08355","#FFC763","#A7D171","#30AB62","#1E7F82","#FF76D7","#F4F4F4"],PASSKEY:"beep8IsAwesome",TOUCH_VJOY:!0,CURSOR:{BLINK_INTERVAL:400},PRINT_ESCAPE_START:"{{",PRINT_ESCAPE_END:"}}",BORDER_CHAR:54},(c=>{c.init=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return c.Utilities.checkFunction("callback",e),c.Utilities.checkObject("options",t),null!==t&&(c.CONFIG=c.Utilities.deepMerge(c.CONFIG,t)),c.Core.init(e)},c.frame=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:30;return c.Core.preflight("beep8.frame"),null!==e&&c.Utilities.checkFunction("render handler",e),null!==t&&c.Utilities.checkFunction("update handler",t),c.Utilities.checkNumber("fps",r),c.Core.setFrameHandlers(e,t,r)},c.render=function(){return c.Core.preflight("beep8.render"),c.Renderer.render()},c.color=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;c.Core.preflight("beep8.color"),c.Utilities.checkNumber("fg",e),void 0!==t&&c.Utilities.checkNumber("bg",t),c.Core.setColor(e,t)},c.getFgColor=function(){return c.Core.preflight("getFgColor"),c.Core.drawState.fgColor},c.getBgColor=function(){return c.Core.preflight("beep8.getBgColor"),c.Core.drawState.bgColor},c.cls=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;c.Core.preflight("beep8.Core.cls"),c.Core.cls(e)},c.locate=function(e,t){c.Core.preflight("beep8.locate"),c.Utilities.checkNumber("col",e),void 0!==t&&c.Utilities.checkNumber("row",t),c.Core.setCursorLocation(e,t)},c.col=function(){return c.Core.preflight("col"),c.Core.drawState.cursorCol},c.row=function(){return c.Core.preflight("row"),c.Core.drawState.cursorRow},c.cursor=function(e){c.Core.preflight("cursor"),c.Utilities.checkBoolean("visible",e),c.CursorRenderer.setCursorVisible(e)},c.print=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=(c.Core.preflight("beep8.text"),c.Utilities.checkString("text",e),c.Utilities.checkNumber("wrapWidth",t),r);null!==n&&(c.Utilities.checkString("fontId",r),n=c.TextRenderer.getFontByName(r)),c.TextRenderer.print(e,n,t)},c.printCentered=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c.CONFIG.SCREEN_COLS,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=(c.Core.preflight("beep8.printCentered"),c.Utilities.checkString("text",e),c.Utilities.checkNumber("width",t),r);null!==n&&(c.Utilities.checkString("fontId",r),n=c.TextRenderer.getFontByName(r)),c.TextRenderer.printCentered(e,t,n)},c.printRight=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c.CONFIG.SCREEN_COLS,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=(c.Core.preflight("beep8.printRight"),c.Utilities.checkString("text",e),c.Utilities.checkNumber("width",t),r);null!==n&&(c.Utilities.checkString("fontId",r),n=c.TextRenderer.getFontByName(r)),c.TextRenderer.printRight(e,t,n)},c.drawText=function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;c.Core.preflight("beep8.drawText"),c.Utilities.checkNumber("x",e),c.Utilities.checkNumber("y",t),c.Utilities.checkString("text",r),n&&c.Utilities.checkString("fontId",n),c.TextRenderer.drawText(e,t,r,n)},c.measure=function(e){return c.Core.preflight("measure"),c.Utilities.checkString("text",e),c.TextRenderer.measure(e)},c.printChar=function(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;c.Core.preflight("beep8.printChar"),e=c.convChar(e),c.Utilities.checkInt("charCode",e),c.Utilities.checkInt("numTimes",r),r<0&&c.Utilities.fatal("[beep8.printChar] numTimes must be a positive integer"),0!==r&&(null!==(t=n)&&(c.Utilities.checkString("fontId",n),t=c.TextRenderer.getFontByName(n)),c.TextRenderer.printChar(e,r,t))},c.printRect=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:8;c.Core.preflight("beep8.printRect"),r=c.convChar(r),c.Utilities.checkNumber("widthCols",e),c.Utilities.checkNumber("heightRows",t),c.Utilities.checkNumber("charCode",r),c.TextRenderer.printRect(e,t,r)},c.printBox=function(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:c.CONFIG.BORDER_CHAR;c.Core.preflight("beep8.printBox"),n=c.convChar(n),c.Utilities.checkNumber("widthCols",e),c.Utilities.checkNumber("heightRows",t),c.Utilities.checkBoolean("fill",r),c.Utilities.checkNumber("borderChar",n),c.TextRenderer.printBox(e,t,r,n)},c.drawImage=function(e,t,r){c.Utilities.checkInstanceOf("image",r,HTMLImageElement),c.Utilities.checkNumber("x",e),c.Utilities.checkNumber("y",t),c.Core.drawImage(r,e,t)},c.drawImageRect=function(e,t,r,n,i,o,a){c.Utilities.checkInstanceOf("image",r,HTMLImageElement),c.Utilities.checkNumber("x",e),c.Utilities.checkNumber("y",t),c.Utilities.checkNumber("srcX",n),c.Utilities.checkNumber("srcY",i),c.Utilities.checkNumber("width",o),c.Utilities.checkNumber("height",a),c.Core.drawImage(r,e,t,n,i,o,a)},c.drawRect=function(e,t,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1;c.Utilities.checkNumber("x",e),c.Utilities.checkNumber("y",t),c.Utilities.checkNumber("width",r),c.Utilities.checkNumber("height",n),c.Utilities.checkNumber("lineWidth",i),c.Core.drawRect(e,t,r,n,i)},c.fillRect=function(e,t,r,n){c.Utilities.checkNumber("x",e),c.Utilities.checkNumber("y",t),c.Utilities.checkNumber("width",r),c.Utilities.checkNumber("height",n),c.Core.fillRect(e,t,r,n)},c.playSound=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];c.Utilities.checkInstanceOf("sfx",e,HTMLAudioElement),e.currentTime=0,e.volume=t,e.loop=r,e.play()},c.spr=function(e,t,r){e=c.convChar(e),c.Utilities.checkNumber("ch",e),c.Utilities.checkNumber("x",t),c.Utilities.checkNumber("y",r),c.TextRenderer.spr(e,t,r)},c.drawActor=function(e,t){e=c.convChar(e),c.Utilities.checkInt("ch",e),c.Utilities.checkString("animation",t),c.Actors.draw(e,t)},c.sprActor=function(e,t,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;return e=c.convChar(e),c.Utilities.checkInt("ch",e),c.Utilities.checkString("animation",t),c.Utilities.checkNumber("x",r),c.Utilities.checkNumber("y",n),c.Actors.spr(e,t,r,n,i)},c.key=function(e){return c.Core.preflight("beep8.key"),c.Utilities.checkString("keyName",e),c.Input.keyHeld(e)},c.playSong=function(e){c.Utilities.checkString("song",e),c.Sound.playSong(e)},c.playSfx=function(e){c.Utilities.checkString("sfx",e),c.Sfx.play(e)},c.keyp=function(e){return c.Core.preflight("beep8.keyp"),c.Utilities.checkString("keyName",e),c.Input.keyJustPressed(e)},c.redefineColors=function(e){c.Core.preflight("beep8.redefineColors"),c.Utilities.checkArray("colors",e),c.Core.defineColors(e)},c.setFont=function(e){c.Core.preflight("beep8.setFont"),c.Utilities.checkString("fontId",e=e||"default-thin"),c.TextRenderer.setFont(e)},c.getFont=function(){c.Core.preflight("beep8.getFont"),c.TextRenderer.getFont()},c.getFontByName=function(e){return c.Utilities.checkString("fontName",e),c.TextRenderer.getFontByName(e)},c.setTileFont=function(e){c.Core.preflight("beep8.setTileFont"),c.Utilities.checkString("fontId",e=e||"tiles"),c.TextRenderer.setTileFont(e)},c.convChar=function(e){return"string"==typeof e&&0<e.length?e.charCodeAt(0):e},c.stopSound=function(e){c.Utilities.checkInstanceOf("sfx",e,HTMLAudioElement),e.currentTime=0,e.pause()},c.getContext=function(){return c.Core.getContext()},c.saveScreen=function(){return c.Core.saveScreen()},c.screenShake=function(e){return c.Utilities.checkNumber("duration",e),c.Renderer.shakeScreen(e)},c.restoreScreen=function(e){return c.Core.restoreScreen(e)},c.wrapText=function(e,t){return c.Utilities.checkString("text",e),c.Utilities.checkNumber("width",t),c.TextRenderer.wrapText(e,t)},c.addScene=function(e){c.Scene.add(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})},c.switchScene=function(e){c.Scene.set(e)},c.getScene=function(){return c.Scene.get()},c.speak=function(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};window.speechSynthesis&&(c.Utilities.checkString("text",e),c.Utilities.checkObject("options",r),(e=new SpeechSynthesisUtterance(e)).pitch=null!=(t=r.pitch)?t:1,e.rate=null!=(t=r.rate)?t:1,e.volume=null!=(t=r.volume)?t:1,speechSynthesis.speak(e))}})(beep8||_readOnlyError("beep8")),(l=>{l._asyncActive=!1,l.Async=l.Async||{},l.Async=new Proxy(l.Async,{get:function(e,c,t){var s=Reflect.get(e,c,t);return"function"==typeof s?_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,r,n,i,o,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for((t=!l._asyncActive)&&(l._asyncActive=!0,l.Scene.pause()),e.prev=2,l.Core.preflight("beep8.Async.".concat(c)),r=a.length,n=new Array(r),i=0;i<r;i++)n[i]=a[i];return e.next=7,s.apply(this,n);case 7:return o=e.sent,e.abrupt("return",o);case 9:return e.prev=9,t&&(l.Scene.resume(),l._asyncActive=!1),e.finish(9);case 12:case"end":return e.stop()}},e,this,[[2,,9,12]])})):s}}),l.Async.key=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Input.readKeyAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),l.Async.pointer=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Input.readPointerAsync();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),l.Async.readLine=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,r,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<i.length&&void 0!==i[0]?i[0]:"",r=1<i.length&&void 0!==i[1]?i[1]:-1,n=2<i.length&&void 0!==i[2]?i[2]:-1,l.Utilities.checkString("initString",t),l.Utilities.checkNumber("maxLen",r),e.next=7,l.Input.readLine(t,r,n);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)})),l.Async.menu=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=1<n.length&&void 0!==n[1]?n[1]:{},l.Utilities.checkArray("choices",t),l.Utilities.checkObject("options",r),e.next=5,l.Menu.display(t,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),l.Async.dialog=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=1<i.length&&void 0!==i[1]?i[1]:["OK"],n=2<i.length&&void 0!==i[2]?i[2]:{},l.Utilities.checkString("prompt",t),l.Utilities.checkArray("choices",r),e.abrupt("return",l.Async.menu(r,_objectSpread({prompt:t,center:!0},n)));case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),l.Async.dialogTypewriter=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,i,o,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=1<a.length&&void 0!==a[1]?a[1]:["OK"],n=2<a.length&&void 0!==a[2]?a[2]:-1,i=3<a.length&&void 0!==a[3]?a[3]:.05,o=4<a.length&&void 0!==a[4]?a[4]:{},l.Utilities.checkString("prompt",t),l.Utilities.checkArray("choices",r),l.Utilities.checkNumber("delay",i),0<n&&(t=l.TextRenderer.wrapText(t,n)),e.next=10,l.Async.menu(r,_objectSpread({prompt:t,typewriter:!0,center:!0},o));case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),l.Async.typewriter=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,i,o,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=1<a.length&&void 0!==a[1]?a[1]:-1,n=2<a.length&&void 0!==a[2]?a[2]:.035,i=3<a.length&&void 0!==a[3]?a[3]:null,l.Utilities.checkString("text",t),l.Utilities.checkNumber("wrapWidth",r),l.Utilities.checkNumber("delay",n),null!==(o=i)&&(l.Utilities.checkString("fontId",i),o=l.TextRenderer.getFontByName(i)),e.next=10,l.TextRenderer.printTypewriter(t,r,n,o);case 10:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),l.Async.loadImage=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.Utilities.checkString("url",t),e.next=3,l.Core.loadImage(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),l.Async.loadSound=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(r){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){var t=new Audio;t.oncanplaythrough=function(){return e(t)},t.src=r,t.load()}));case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),l.Async.loadFont=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,i,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=1<o.length&&void 0!==o[1]?o[1]:1,n=2<o.length&&void 0!==o[2]?o[2]:1,l.Utilities.checkString("fontImageFile",t),l.Utilities.checkNumber("tileSizeWidthMultiplier",r),l.Utilities.checkNumber("tileSizeHeightMultiplier",n),i="FONT@"+l.Utilities.makeUrlPretty(t),e.next=8,l.TextRenderer.loadFontAsync(i,t,r,n);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),l.Async.wait=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.Utilities.checkNumber("seconds",t),l.Renderer.render(),e.next=4,new Promise(function(e){return setTimeout(e,Math.round(1e3*t))});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),l.Async.waitForContinue=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l.Async.key();case 3:if((t=e.sent).includes("Enter")||t.includes("ButtonA")||t.includes(" "))return e.abrupt("break",8);e.next=6;break;case 6:e.next=0;break;case 8:case"end":return e.stop()}},e)}))})(beep8||_readOnlyError("beep8")),(c=>{function s(e,t,r,n,i){var o=c.TextRenderer.curActors_,e=e*o.getColCount()+Math.abs(l(t));c.TextRenderer.spr(e,r,n,o,i||0)}c.Actors={},c.Actors.animations={idle:{frames:[0],fps:1},"idle-right":{frames:[1],fps:1},"idle-left":{frames:[-1],fps:1},"idle-up":{frames:[4],fps:1},"move-right":{frames:[1,2],fps:4,loop:!0},"move-left":{frames:[-1,-2],fps:4,loop:!0},"move-up":{frames:[5,-5],fps:4,loop:!0},"move-down":{frames:[3,-3],fps:4,loop:!0},"jump-right":{frames:[5],fps:1,loop:!1},"jump-left":{frames:[-5],fps:1,loop:!1},"spin-left":{frames:[0,1,4,-1],fps:4,loop:!0},"spin-right":{frames:[0,-1,4,1],fps:4,loop:!0}},c.Actors.draw=function(e,t){c.Utilities.checkInt("ch",e),c.Utilities.checkString("animation",t);var r=l(t);s(e,t,c.Core.drawState.cursorCol*c.CONFIG.CHR_WIDTH,c.Core.drawState.cursorRow*c.CONFIG.CHR_HEIGHT,(0<=r?0:1)||0)},c.Actors.spr=function(e,t,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,o=(c.Utilities.checkInt("ch",e),c.Utilities.checkString("animation",t),c.Utilities.checkNumber("x",r),c.Utilities.checkNumber("y",n),null!==i&&c.Utilities.checkNumber("startTime",i),l(t,i)),a=c.Actors.animations[t],o=0<=o?0:1;return!!u(a,i)&&(s(e,t,r,n,o||0),!0)};var l=function(e){var t,r,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=(void 0===c.Actors.animations[e]&&c.Utilities.fatal("Invalid animation: "+e),null===n&&(n=c.Core.startTime),c.Actors.animations[e]),i=0;return 1===e.frames.length&&(i=e.frames[0]),1<e.frames.length&&(n=c.Core.getNow()-n,t=e.frames.length,r=1/e.fps,n=Math.floor(n/1e3/r%t),i=e.frames[n]),i},u=function(e,t){return null===t||!0===e.loop||(e=e.frames.length*(1e3/e.fps),!(c.Core.getNow()-t>=e))}})(beep8||_readOnlyError("beep8")),(e=>{e.Collision={},e.COLLISION={},e.COLLISION.NONE=0,e.COLLISION.N=1,e.COLLISION.E=2,e.COLLISION.S=4,e.COLLISION.W=8,e.COLLISION.NE=e.COLLISION.N+e.COLLISION.E,e.COLLISION.NS=e.COLLISION.N+e.COLLISION.S,e.COLLISION.NW=e.COLLISION.N+e.COLLISION.W,e.COLLISION.SE=e.COLLISION.S+e.COLLISION.E,e.COLLISION.SW=e.COLLISION.S+e.COLLISION.W,e.COLLISION.WE=e.COLLISION.W+e.COLLISION.E,e.COLLISION.WNE=e.COLLISION.W+e.COLLISION.N+e.COLLISION.E,e.COLLISION.WES=e.COLLISION.W+e.COLLISION.E+e.COLLISION.S,e.COLLISION.NES=e.COLLISION.N+e.COLLISION.E+e.COLLISION.S,e.COLLISION.ALL=e.COLLISION.N+e.COLLISION.E+e.COLLISION.S+e.COLLISION.W})(beep8||_readOnlyError("beep8")),(h=>{h.Core={},h.Core.realCanvas=null,h.Core.realCtx=null,h.Core.canvas=null,h.Core.ctx=null,h.Core.container=null,h.Core.startTime=0,h.Core.deltaTime=0,h.Core.crashed=!1,h.Core.crashing=!1,h.Core.drawState={fgColor:7,bgColor:0,cursorCol:0,cursorRow:0,cursorVisible:!1};var o=null,a=!1,c=null,s=null,l=0,u=0,n=null,d=(h.Core.init=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};h.Utilities.checkFunction("callback",e),t&&h.Utilities.checkObject("options",t),h.CONFIG=_objectSpread(_objectSpread({},h.CONFIG),t),h.Core.initScreenshot(),h.Core.asyncInit(e),h.Core.startTime=h.Core.getNow(),h.Utilities.event("initComplete")},h.Core.initialized=function(){return a},h.Core.asyncInit=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,r,n,i,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<o.length&&void 0!==o[0]?o[0]:null,h.Utilities.log("beep8 System initializing"),h.CONFIG.SCREEN_WIDTH=h.CONFIG.SCREEN_COLS*h.CONFIG.CHR_WIDTH,h.CONFIG.SCREEN_HEIGHT=h.CONFIG.SCREEN_ROWS*h.CONFIG.CHR_HEIGHT,h.Core.realCanvas=document.createElement("canvas"),h.CONFIG.CANVAS_SETTINGS&&h.CONFIG.CANVAS_SETTINGS.CANVAS_ID&&h.Core.realCanvas.setAttribute("id",h.CONFIG.CANVAS_SETTINGS.CANVAS_ID),h.CONFIG.CANVAS_SETTINGS&&h.CONFIG.CANVAS_SETTINGS.CANVAS_CLASSES){r=_createForOfIteratorHelper(h.CONFIG.CANVAS_SETTINGS.CANVAS_CLASSES);try{for(r.s();!(n=r.n()).done;)i=n.value,h.Core.realCanvas.classList.add(i)}catch(e){r.e(e)}finally{r.f()}}return h.Core.realCanvas.style.touchAction="none",h.Core.realCanvas.style.userSelect="none",h.Core.realCanvas.style.imageRendering="pixelated",h.Core.realCanvas.addEventListener("touchstart",function(e){return e.preventDefault()}),h.Core.container=document.createElement("div"),h.Core.container.setAttribute("style",""),h.Core.container.id="beep8",h.Core.container.style.display="block",h.Core.container.style.lineHeight="0",h.Core.container.style.position="relative",h.Core.container.appendChild(h.Core.realCanvas),h.Core.getBeepContainerEl().appendChild(h.Core.container),h.Core.canvas=document.createElement("canvas"),h.Core.canvas.width=h.CONFIG.SCREEN_WIDTH,h.Core.canvas.height=h.CONFIG.SCREEN_HEIGHT,h.Core.canvas.style.width=h.CONFIG.SCREEN_WIDTH+"px",h.Core.canvas.style.height=h.CONFIG.SCREEN_HEIGHT+"px",h.Core.ctx=h.Core.canvas.getContext("2d",{willReadFrequently:!0}),h.Core.ctx.imageSmoothingEnabled=!1,e.next=28,h.TextRenderer.initAsync();case 28:return h.Input.init(),h.Core.updateLayout(!1),window.addEventListener("resize",function(){return h.Core.updateLayout(!0)}),h.Core.isMobile()&&h.Joystick.setup(),a=!0,h.Utilities.log("beep8 System initialized"),e.next=36,h.Intro.loading();case 36:return e.next=38,h.Intro.splash();case 38:if(t)return e.next=41,t();e.next=41;break;case 41:case"end":return e.stop()}},e)})),h.Core.getBeepContainerEl=function(){var e,t=document.body;return h.CONFIG.CANVAS_SETTINGS&&h.CONFIG.CANVAS_SETTINGS.CONTAINER&&("string"==typeof(e=h.CONFIG.CANVAS_SETTINGS.CONTAINER)?(t=document.getElementById(e.replace("#","")))||h.Utilities.fatal("beep8: Could not find container element with ID: "+e):t=e instanceof HTMLElement?e:(h.Utilities.error("beep8: beep8.CONFIG.CANVAS_SETTINGS.CONTAINER must be either an ID of an HTMLElement."),document.body)),t},h.Core.preflight=function(e){if(h.Core.crashed)throw new Error("Can't call API method ".concat(e,"() because the engine has crashed."));a||h.Utilities.fatal("Can't call API method ".concat(e,"(): API not initialized. ")+"Call initAsync() wait until it finishes before calling API methods."),n&&h.Utilities.fatal("Can't call API method ".concat(e,"() because there is a pending async ")+"call to ".concat(n.name,"() that hasn't finished running yet. Are you missing ")+"an 'await' keyword to wait for the async method? Use 'await ".concat(n.name,"()',")+"not just '".concat(n.name,"()'"))},h.Core.startAsync=function(e,t,r){if(n)throw new Error("Internal bug: startAsync called while pendingAsync is not null. Missing preflight() call?");n={name:e,resolve:t,reject:r},h.Renderer.render()},h.Core.hasPendingAsync=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return null===e?!!n:n&&n.name===e},h.Core.endAsyncImpl=function(e,t,r){if(!n)throw new Error("Internal bug: endAsync(".concat(e,") called with no pendingAsync"));if(n.name!==e)throw new Error("Internal bug: endAsync(".concat(e,") called but pendingAsync.name ")+"is ".concat(n.name));e=t?n.reject:n.resolve;n=null,e(r)},h.Core.resolveAsync=function(e,t){h.Core.endAsyncImpl(e,!1,t)},!(h.Core.failAsync=function(e,t){h.Core.endAsyncImpl(e,!0,t)})),f=null,g=(h.Core.setFrameHandlers=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;c=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:null)||function(){},s=e||function(){},l=1/(2<arguments.length&&void 0!==arguments[2]?arguments[2]:30),u=0,o=h.Core.getNow(),f&&(window.cancelAnimationFrame(f),f=null),d=!0,f=window.requestAnimationFrame(h.Core.doFrame)},h.Core.doFrame=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,r,n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}return e.abrupt("return");case 2:for(t=h.Core.getNow(),r=(t-o)/1e3,o=t,h.Core.deltaTime=r,r=Math.min(r,.05),u+=r,n=Math.floor(u/l),10<n&&(n=10,u=0),i=0;i<n;i++)c&&c(l),h.Input&&"function"==typeof h.Input.onEndFrame&&h.Input.onEndFrame(),h.Particles.update(l);u%=l,s&&s(),h.Renderer.render(),f=window.requestAnimationFrame(h.Core.doFrame);case 16:case"end":return e.stop()}},e)})),h.Core.stopFrame=function(){d=!1,f&&(window.cancelAnimationFrame(f),f=null)},h.Core.cls=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0)||h.Core.drawState.bgColor;h.Utilities.checkNumber("bgColor",e),h.Core.ctx.fillStyle=h.Core.getColorHex(e),h.Core.ctx.fillRect(0,0,h.Core.canvas.width,h.Core.canvas.height),h.Core.setCursorLocation(0,0),h.Renderer.markDirty()},h.Core.defineColors=function(e){h.Utilities.checkArray("colors",e),h.CONFIG.COLORS=e.slice(),h.TextRenderer.regenColors()},h.Core.setColor=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;h.Utilities.checkNumber("fg",e),h.Core.drawState.fgColor=Math.round(e),void 0!==t&&(h.Utilities.checkNumber("bg",t),h.Core.drawState.bgColor=Math.round(t))},h.Core.setCursorLocation=function(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];h.Utilities.checkNumber("col",e),h.Core.drawState.cursorCol=r?Math.round(e):e,void 0!==t&&(h.Utilities.checkNumber("row",t),h.Core.drawState.cursorRow=r?Math.round(t):t)},h.Core.nextCursorLocation=function(){var e=h.Core.drawState.cursorCol,t=h.Core.drawState.cursorRow;h.Core.setCursorLocation(e+1,t)},h.Core.getColorHex=function(e){return"number"!=typeof e?"#f0f":e<0?"#000":(e=h.Utilities.clamp(Math.round(e),0,h.CONFIG.COLORS.length-1),h.CONFIG.COLORS[e])},h.Core.getNow=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},h.Core.drawImage=function(e,t,r,n,i,o,a){h.Utilities.checkInstanceOf("img",e,HTMLImageElement),h.Utilities.checkNumber("x",t),h.Utilities.checkNumber("y",r),void 0!==n&&h.Utilities.checkNumber("srcX",n),void 0!==i&&h.Utilities.checkNumber("srcY",i),void 0!==o&&h.Utilities.checkNumber("width",o),void 0!==a&&h.Utilities.checkNumber("height",a),void 0!==n&&void 0!==i&&void 0!==o&&void 0!==a?h.Core.ctx.drawImage(e,n,i,o,a,t,r,o,a):h.Core.ctx.drawImage(e,t,r)},h.Core.loadImage=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.Utilities.log("load image",t),e.abrupt("return",new Promise(function(u){var d=new Image;d.crossOrigin="Anonymous",d.onload=function(){for(var e=document.createElement("canvas"),t=e.getContext("2d"),r=(e.width=d.width,e.height=d.height,t.drawImage(d,0,0),t.getImageData(0,0,e.width,e.height)),n=r.data,i=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4;if(0===Object.keys(g).length)for(var r=e.map(function(e){return h.Utilities.hexToRgb(e)}),n=0;n<256;n+=t)for(var i=0;i<256;i+=t)for(var o=0;o<256;o+=t){var a="".concat(n,",").concat(i,",").concat(o);g[a]=((e,t,r,n)=>{var i,o=null,a=1/0,c=_createForOfIteratorHelper(n);try{for(c.s();!(i=c.n()).done;){var s=i.value,l=Math.pow(s.r-e,2)+Math.pow(s.g-t,2)+Math.pow(s.b-r,2);l<a&&(a=l,o=s)}}catch(e){c.e(e)}finally{c.f()}return o})(n,i,o,r)}return g}(h.CONFIG.COLORS),o=0;o<n.length;o+=4){var a=function(e,t,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:4,e=Math.floor(e/i)*i,t=Math.floor(t/i)*i,r=Math.floor(r/i)*i,i="".concat(e,",").concat(t,",").concat(r);return n[i]}(n[o],n[o+1],n[o+2],i),c=a.r,s=a.g,a=a.b;n[o]=c,n[o+1]=s,n[o+2]=a}t.putImageData(r,0,0);var l=new Image;l.onload=function(){return u(l)},l.src=e.toDataURL()},d.src=t}));case 2:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),h.Core.drawRect=function(e,t,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,o=(h.Utilities.checkNumber("x",e),h.Utilities.checkNumber("y",t),h.Utilities.checkNumber("width",r),h.Utilities.checkNumber("height",n),h.Utilities.checkNumber("lineWidth",i),h.Core.ctx.strokeStyle),a=h.Core.ctx.lineWidth;h.Core.ctx.strokeStyle=h.Core.getColorHex(h.Core.drawState.fgColor),h.Core.ctx.lineWidth=i,h.Core.ctx.strokeRect(Math.round(e),Math.round(t),Math.round(r),Math.round(n)),h.Core.ctx.strokeStyle=o,h.Core.ctx.lineWidth=a},h.Core.fillRect=function(e,t,r,n){h.Utilities.checkNumber("x",e),h.Utilities.checkNumber("y",t),h.Utilities.checkNumber("width",r),h.Utilities.checkNumber("height",n),h.Core.ctx.fillStyle=h.Core.getColorHex(h.Core.drawState.fgColor),h.Core.ctx.fillRect(Math.round(e)+.5,Math.round(t)+.5,Math.round(r)-1,Math.round(n)-1)},h.Core.initScreenshot=function(){var e;h.Core.initialized()||(e=function(e){"0"===e.key&&h.Core.downloadScreenshot()},document.addEventListener("pointerup",e),document.addEventListener("keyup",e))},h.Core.saveScreen=function(){return h.Core.ctx.getImageData(0,0,h.Core.canvas.width,h.Core.canvas.height)},h.Core.downloadScreenshot=function(){var e=h.Core.getHighResDataURL(h.Core.realCanvas);h.Utilities.downloadFile("beep8-screenshot.png",e)},h.Core.getHighResDataURL=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"image/png",n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=document.createElement("canvas"),o=(i.width=e.width*t,i.height=e.height*t,i.getContext("2d"));return o.imageSmoothingEnabled=!1,o.scale(t,t),o.drawImage(e,0,0),i.toDataURL(r,n)},h.Core.restoreScreen=function(e){h.Utilities.checkInstanceOf("screenData",e,ImageData),h.Core.ctx.putImageData(e,0,0)},h.Core.updateLayout=function(e){h.Core.updateLayout2d(),e&&h.Renderer.render()},h.Core.updateLayout2d=function(){h.Core.realCtx=h.Core.realCanvas.getContext("2d",{willReadFrequently:!0}),h.Core.realCtx.imageSmoothingEnabled=!1,h.CONFIG.SCREEN_EL_WIDTH=h.CONFIG.SCREEN_WIDTH,h.CONFIG.SCREEN_EL_HEIGHT=h.CONFIG.SCREEN_HEIGHT,h.CONFIG.SCREEN_REAL_WIDTH=h.CONFIG.SCREEN_WIDTH,h.CONFIG.SCREEN_REAL_HEIGHT=h.CONFIG.SCREEN_HEIGHT,h.Core.realCanvas.style.width="100%",h.Core.realCanvas.style.height="100%",h.Core.realCanvas.style.filter="blur(0.5px)",h.Core.realCanvas.width=h.CONFIG.SCREEN_REAL_WIDTH,h.Core.realCanvas.height=h.CONFIG.SCREEN_REAL_HEIGHT,h.Core.container.style.aspectRatio="".concat(h.CONFIG.SCREEN_COLS," / ").concat(h.CONFIG.SCREEN_ROWS)},h.Core.handleCrash=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Fatal error";h.Core.crashed||h.Core.crashing||(h.Core.crashing=!0,h.Core.setColor(h.CONFIG.COLORS.length-1,0),h.Core.cls(),h.Core.setCursorLocation(1,1),h.TextRenderer.print("*** CRASH ***:\n"+e,null,h.CONFIG.SCREEN_COLS-2),h.Renderer.render(),h.Core.crashing=!1,h.Core.crashed=!0)},h.Core.isTouchDevice=function(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints},h.Core.isMobile=function(){return h.Core.isIOS()||h.Core.isAndroid()||h.Core.isTouchDevice()},h.Core.isIOS=function(){return/(ipad|ipod|iphone)/i.test(navigator.userAgent)},h.Core.isAndroid=function(){return/android/i.test(navigator.userAgent)},{})})(beep8||_readOnlyError("beep8")),(i=>{i.CursorRenderer={};var o=0,t=null;i.CursorRenderer.setCursorVisible=function(e){i.Utilities.checkBoolean("visible",e),i.Core.drawState.cursorVisible!==e&&(i.Core.drawState.cursorVisible=e,o=0,i.Renderer.render(),null!==t&&(clearInterval(t),t=null),e)&&(t=setInterval(function(){o=(o+1)%2,i.Renderer.render()},i.CONFIG.CURSOR.BLINK_INTERVAL))},i.CursorRenderer.draw=function(e){var t,r,n;i.Utilities.checkInstanceOf("targetCtx",e,CanvasRenderingContext2D),!i.Core.drawState.cursorVisible||o<=0||(t=i.TextRenderer.getFont(),r=i.Core.drawState.cursorCol*i.CONFIG.CHR_WIDTH,n=i.Core.drawState.cursorRow*i.CONFIG.CHR_HEIGHT,e.fillStyle=i.Core.getColorHex(i.Core.drawState.fgColor),e.fillRect(1+r,1+n,t.charWidth_-2,t.charHeight_-2))}})(beep8||_readOnlyError("beep8")),(c=>{c.ECS={};var a=0,s=new Map,l=[],i=new Map;c.ECS.entitiesAt=function(e,t){return null!=(t=null==(t=l[t])?void 0:t[e])?t:[]},c.ECS.addSystem=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;c.Utilities.checkFunction("fn",t),c.Utilities.checkString("name",e),c.Utilities.checkInt("order",r),i.has(e)&&c.Utilities.warn('ECS: overwriting existing system "'.concat(e,'"')),i.set(e,{fn:t,order:r})},c.ECS.addSystemOnce=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;c.Utilities.checkFunction("fn",e),c.Utilities.checkString("name",t),c.Utilities.checkInt("order",r),i.has(t)||c.ECS.addSystem(e,t,r)},c.ECS.removeSystem=function(e){i.delete(e)},c.ECS.run=function(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){return!0};_toConsumableArray(i.entries()).sort(function(e,t){return e[1].order-t[1].order}).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1].fn;n(t)&&e(r)})},c.ECS.add=function(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};c.Utilities.checkInt("id",e),c.Utilities.checkString("name",r),c.Utilities.checkObject("data",n),t=r,s.has(t)||s.set(t,new Map),s.get(t).set(e,n),"Loc"===r&&c.ECS.setLoc(e,n.x,n.y)},c.ECS.set=function(e,t,r){c.ECS.add(e,t,r)},c.ECS.setLoc=function(e,t,r){c.Utilities.checkInt("id",e),c.Utilities.checkInt("x",t),c.Utilities.checkInt("y",r);var n,i=this.getComponent(e,"Loc"),o=l[i.y];o&&(o=o[i.x])&&-1!==(n=o.indexOf(e))&&o.splice(n,1),i.x=t,l[i.y=r]||(l[r]=[]),l[r][t]||(l[r][t]=[]),l[r][t].push(e)},c.ECS.get=function(e){return c.Utilities.checkString("name",e),null!=(e=s.get(e))?e:new Map},c.ECS.getEntity=function(e){c.Utilities.checkInt("id",e);var t,r=new Map,n=_createForOfIteratorHelper(s);try{for(n.s();!(t=n.n()).done;){var i=_slicedToArray(t.value,2),o=i[0],a=i[1];a.has(e)&&r.set(o,a.get(e))}}catch(e){n.e(e)}finally{n.f()}return r},c.ECS.getComponent=function(e,t){return null==(t=s.get(t))?void 0:t.get(e)},c.ECS.hasComponent=function(e,t){return null!=(t=null==(t=s.get(t))?void 0:t.has(e))&&t},c.ECS.removeComponent=function(e,t){null!=(t=s.get(t))&&t.delete(e)},c.ECS.removeEntity=function(e){var t,r,n=this.getComponent(e,"Loc"),i=(n&&(t=null==(t=l[n.y])?void 0:t[n.x])&&t.splice(t.indexOf(e),1),_createForOfIteratorHelper(s.values()));try{for(i.s();!(r=i.n()).done;)r.value.delete(e)}catch(e){i.e(e)}finally{i.f()}},c.ECS.create=function(e){for(var t=a++,r=0,n=Object.entries(e);r<n.length;r++){var i=_slicedToArray(n[r],2),o=i[0];c.ECS.add(t,o,i[1])}return t},c.ECS.query=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return 0!==r.length&&(e=s.get(r[0]))?_toConsumableArray(e.keys()).filter(function(t){return r.every(function(e){return null==(e=s.get(e))?void 0:e.has(t)})}):[]},c.ECS.countByType=function(e){var t=this.get("Type");if(!t)return 0;var r,n=0,i=_createForOfIteratorHelper(t.values());try{for(i.s();!(r=i.n()).done;)r.value.name===e&&n++}catch(e){i.e(e)}finally{i.f()}return n},c.ECS.reset=function(){s=new Map,i=new Map,l=[],a=0}})(beep8||_readOnlyError("beep8")),(e=>{e.Hooks={};var a={},s={};function r(e,t,r,n){n=3<arguments.length&&void 0!==n?n:10;e[t]||(e[t]=[]),e[t].push({callback:r,priority:n}),e[t].sort(function(e,t){return e.priority-t.priority})}e.Hooks.addAction=function(e,t){r(a,e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:10)},e.Hooks.doAction=function(e){if(a[e]){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i,o=_createForOfIteratorHelper(a[e]);try{for(o.s();!(i=o.n()).done;)i.value.callback.apply(void 0,r)}catch(e){o.e(e)}finally{o.f()}}},e.Hooks.addFilter=function(e,t){r(s,e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:10)},e.Hooks.applyFilters=function(e,t){if(!s[e])return t;for(var r=t,n=arguments.length,i=new Array(2<n?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];var a,c=_createForOfIteratorHelper(s[e]);try{for(c.s();!(a=c.n()).done;)r=a.value.callback.apply(void 0,[r].concat(i))}catch(e){c.e(e)}finally{c.f()}return r},e.Hooks.removeAction=function(e,t){a[e]=(a[e]||[]).filter(function(e){return e.callback!==t})},e.Hooks.removeFilter=function(e,t){s[e]=(s[e]||[]).filter(function(e){return e.callback!==t})}})(beep8||_readOnlyError("beep8")),(g=>{g.Input={};var a=null,c=null;g.Input.init=function(){a=new Set,c=new Set,window.addEventListener("keydown",function(e){return g.Input.onKeyDown(e)}),window.addEventListener("keyup",function(e){return g.Input.onKeyUp(e)}),window.addEventListener("pointerdown",function(e){return g.Input.onPointerDown(e)})},g.Input.keyHeld=function(e){return a.has(e.toUpperCase())},g.Input.keyJustPressed=function(e){return c.has(e.toUpperCase())},g.Input.onEndFrame=function(){c.clear()},g.Input.onKeyDown=function(e){var t,r=e.key,n=g.Input.getKeys(r),i=(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(r)&&e.preventDefault(),_createForOfIteratorHelper(n));try{for(i.s();!(t=i.n()).done;){var o=t.value;c.add(o.toUpperCase()),a.add(o.toUpperCase())}}catch(e){i.e(e)}finally{i.f()}g.Core.hasPendingAsync("beep8.Async.key")&&g.Core.resolveAsync("beep8.Async.key",n)},g.Input.onPointerDown=function(e){g.Core.hasPendingAsync("beep8.Async.pointer")&&g.Core.resolveAsync("beep8.Async.pointer",{x:e.clientX,y:e.clientY})},g.Input.onKeyUp=function(e){if(e.key){var t,e=e.key.toUpperCase(),r=_createForOfIteratorHelper(g.Input.getKeys(e));try{for(r.s();!(t=r.n()).done;){var n=t.value;a.delete(n.toUpperCase())}}catch(e){r.e(e)}finally{r.f()}}},g.Input.readKeyAsync=function(){return new Promise(function(e,t){g.Core.startAsync("beep8.Async.key",e,t)})},g.Input.readPointerAsync=function(){return new Promise(function(e,t){g.Core.startAsync("beep8.Async.pointer",e,t)})},g.Input.getKeys=function(e){var t=[e];switch(e.toUpperCase()){case"W":t.push("ArrowUp");break;case"A":t.push("ArrowLeft");break;case"S":t.push("ArrowDown");break;case"D":t.push("ArrowRight");break;case"Enter":t.push("Escape");break;case"Z":case"N":t.push("ButtonA");break;case"X":case"M":t.push("ButtonB")}return t},g.Input.readLine=(()=>{var r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,r){var n,i,o,a,c,s,l,u,d,h,f=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=2<f.length&&void 0!==f[2]?f[2]:-1,i=g.Core.drawState.cursorCol,a=g.Core.drawState.cursorRow,o=i,a=a,c=[t],s=0,l=g.Core.drawState.cursorVisible,g.CursorRenderer.setCursorVisible(!0);case 9:return g.Core.setCursorLocation(o,a),g.TextRenderer.print(c[s]||""),e.next=14,g.Input.readKeyAsync();case 14:u=e.sent,u=_createForOfIteratorHelper(u),e.prev=16,u.s();case 18:if((d=u.n()).done)e.next=42;else if("Backspace"!==(h=d.value))e.next=32;else if(0!==c[s].length)e.next=26;else{if(0===s)return e.abrupt("continue",40);e.next=24}break;case 24:s--,a--;case 26:c[s]=0<c[s].length?c[s].substring(0,c[s].length-1):c[s],g.Core.setCursorLocation(o+g.TextRenderer.measure(c[s]).cols,a,!1),g.TextRenderer.print(" "),g.Sfx.play(g.CONFIG.SFX.TYPING),e.next=40;break;case 32:if("Enter"===h)return g.Core.setCursorLocation(1,a+1),g.CursorRenderer.setCursorVisible(l),g.Sfx.play(g.CONFIG.SFX.TYPING),e.abrupt("return",c.join(""));e.next=39;break;case 39:1===h.length&&((c.join("").length<r||-1===r)&&(c[s]+=h,-1!==n)&&c[s].length>=n&&(g.TextRenderer.print(c[s].charAt(c[s].length-1)),o=i,c[++s]="",a++),g.Sfx.play(g.CONFIG.SFX.TYPING));case 40:e.next=18;break;case 42:e.next=47;break;case 44:e.prev=44,e.t0=e.catch(16),u.e(e.t0);case 47:return e.prev=47,u.f(),e.finish(47);case 50:e.next=9;break;case 52:case"end":return e.stop()}},e,null,[[16,44,47,50]])}));return function(e,t){return r.apply(this,arguments)}})()})(beep8||_readOnlyError("beep8")),(r=>{r.Intro={},r.Intro.loading=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.color(0,4),r.cls(),r.locate(1,1),r.print("8> beep8 Loading...\n"),e.next=7,r.Async.wait(.4);case 7:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),r.Intro.splash=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.Tilemap.load("mBqYHoMBBACDAAMEgwADBIMBBACDAQQAgxh6AwSDGJkDBIMBBACDAQQAgwEEAIMDAwSDAwMEgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAAA8AAA8AmB6DAQQAgwADBIMAAwSDAAMEgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwMDBIMDAwSDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAAQEgwAEBIMABAQADwAADwCYHoMBBACDGJIDBIMYNwMEgxhbAwSDGDcDBIMYNwMEgxg3AwSDGQEEAwSDGDcDBIMYNwMEgxg3AwSDGDcDBIMYNwMEgxg3AwSDGDcDBIMZARYDBIMYNwMEgxg4AwSDAQQAgwEEAIMBBACDAAQEgwMDBIMBBAAADwAADwCYHoMPBQSDGEgDBIMCDwSDAQ8AgxMPBIMBBACDGQGIDwSDGQGHDwSDGQGJDwSDGE4FBIMZAVMPBIMZAVQPBIMZAVUPBIMYTgUEgwEPBIMBDwCDEw8EgxhKAwSDAQQAgwEEAIMBBACDDwUEgwEEAIMBBAAADwAADwCYHoMBBACDGEgDBIMBDwCDGHIFBIMBDwCDGE4FBIMZAZkPBIMYcgUEgxg9BQSDGK8FBIMZAVMPBIMYcgUEgxg9BQSDGK8FBIMLDwSDGHIFBIMLDwSDGEgDBIMBBACDAQQAgwEEAIMABASDAQQAgw8FBAAPAAAPAJgegwEEAIMYSgMEgwEPAIMBDwCDFwQPgwEEAIMZAZ0PBIMBDwSDGE4FBIMBBACDGQFUDwSDGQFTDwSDGE4BBIMBBACDAQ8EgwEPAIMYJQ8FgxhuDwSDGG4PBIMYlw8EgwAPBIMABASDAQQAgwEEAAAPAAAPAJgegwEEAIMYSAMEgwkPBIMYcgUEgwEPAIMYTgEEgxkBnQ8EgxhyBQSDGK8FBIMBBACDGQFTDwSDGHIFBIMYrwUEgwEEAIMBDwSDGHIFBIMYPQUEgxhIAwSDAQQAgwEEAIMBBACDAAQEgwAEBIMABAQADwAADwCYHoMBBACDGEgDBIMYTw8EgwEPAIMYJQ8FgxhOBQSDGQGaDwSDEgoPgxgcBQqDGBkFCoMYHQUKgxMKD4MYHQUPgxhOBQSDBg8EgxhOBQSDDwMEgxhIAwSDDgUEgwEEAIMBBACDAQQAgwEEAIMBBAAADwAADwCYHoMBBACDGFoDBIMYNwMEgxg3AwSDGDcDBIMYNwMEgxg3AwSDAQoEgxgrCgWDGDcDBIMYKwQKgwEKBIMYKwUEgxg3AwSDGFsDBIMYNwMEgxg3AwSDGKUDBIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAAAPAAAPAJgegwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMYJAoEgxguBQqDGBkKBIMYLwQKgxglCgWDGCsBBIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAAA8AAA8AmB6DAQQAgxgpAwSDAQQAgwEEAIMBBACDAQQAgwEEAIMSCgSDGBwFCoMYGQEKgxgdBQqDEwoFgxgiBQSDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAAAPAAAPAJgegxiXDwODGJcPA4MYGAMEgwEEAIMBBACDAQQAgw0FBIMLBAqDGCsKBYMABASDGCsECoMBCgSDGDIFBIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMDAwSDAwMEgwEEAIMBBACDAQQAAA8AAA8AmB6DAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgxgkCgSDGC4FCoMYGQoEgxgvBAqDGCUKBYMYKwUEgwAFCoMYHQEEgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAAA8AAA8AmB6DAQQAgwEEAIMBBACDAQQAgwEEAIMACgSDAAoEgwAKBIMYLgUEgxgZBAWDGBkEAYMYGQQFgxgvBQSDGC4FBIMYLwUEgwEEAIMBBACDAQQAgwEEAIMYrAMEgxg3AwSDGDcDBIMYWwMEgxg3AwQADwAADwCYHoMYNwMEgxg3AwSDGJsDBIMBBACDAQQAgwEEAIMBBACDAQQEgwEEBIMBBASDAQQEgwEEBIMBBACDAQQAgwEEAIMBBACDGQHlAwSDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAAA8AAA8AmB6DAQQAgwEEAIMBBACDAQQAgwEEAIMYbgMEgxhuAwSDGG4DBIMYbgMEgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAAA8AAA8AmB6DAA8EgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwADBIMYegMEgxiZAwSDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMAAwSDAAMEgwADBAAPAAAPAJgegxgcCgSDGB0KBIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgxgpAwSDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAAA8AAA8AmB6DGC4KBIMYLwoEgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgxgpAwSDGCkDBIMBBACDAQQAgwEEAIMBBACDAQQAgxcDBIMBAwSDGBgDBIMAAwSDAQQAgxh0AwSDGIYDBIMABQSDAQQAAA8AAA8AmB6DAQQAgwEEAIMBBACDAA8EgwEEAIMBBACDAQQAgxcDBIMCAwSDAQMEgxgYAwSDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDAAMEgwADBIMYdAMEgxkBbAUEgwEEAIMZAUYFBIMBBAAADwAADwCYHoMWAwSDGCgDBIMBBACDAQQAgxh0AwSDEAMEgwEEAIMBBACDAQQAgwEEAIMBBACDAQQAgwEEAIMBBACDFgMEgxgoAwSDGHQDBIMYhgMEgxkBbAUEgwAFBIMABQWDAQUEgwEFBIMBBQQADwAADwCYHoMYKAUDgwAFA4MYKAMEgxh0AwSDAQQAgwEEAIMNBQSDAQQAgwEEAIMYdAMEgxiGAwSDFgMEgxgoAwSDFgMEgwEDBIMBAwSDEAMEgxi0BQSDAAEFgwMBBYMABQWDAQUEgwEFBIMBBQQADwAADwCYHoMBBQSDGCgFA4MABQODGCgDBIMYuAUEgwEEAIMBBACDGIYDBIMYdAMEgxi4BQSDDwMEgwsDBIMBAwSDAQMEgxkBagUDgwEDBIMYnAUDgwADBYMAAQWDAQUEgwAFBYMPAQWDAQUEgwEFBAAPAAAPAJgegwMBBYMBBQSDAQUEgwEFBIMBBQSDAQUEgwEFBIMBBQSDAQUEgwEFBIMBBQSDAQUEgwEFBIMBBQSDAQUEgwEFBIMBBQSDAQUEgw8BBYMRAQWDDwEFgwMFAYMBBQSDAQUEAA8AAA8AloMRAQWDEQEFgwMBBYMDAQWDAwEFgwMBBYMADwWDAwEFgwMBBYMADwWDAA8FgwAPBYMDAQWDAA8FgwAPBYMADwWDDwEFgwsBBYMRAQWDCwEFgxhYBQGDAA8BloMADwGDEAEFgwAPBYMADwWDAA8FgwAPBYMADwWDAQEFgxABBYMADwWDAA8FgwAPBYMADwWDAA8FgwkBBYMADwWDAA8FgwQBBYMADwGDAA8BgwAPAYMABQE="),r.locate(0,0),r.Tilemap.draw(t),t="Click to start",r.Core.isTouchDevice()&&(t="Tap to start"),r.color(4,5),r.locate(0,r.CONFIG.SCREEN_ROWS-2),r.printCentered(t,r.CONFIG.SCREEN_COLS),e.next=10,r.Input.readPointerAsync();case 10:r.color(15,0),r.cls();case 12:case"end":return e.stop()}},e)}))})(beep8||_readOnlyError("beep8")),(f=>{f.Menu={},f.Menu.display=(()=>{var r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,r){var n,i,o,a,c,s,l,u,d,h;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=r||{},f.Utilities.checkArray("choices",t),f.Utilities.checkObject("options",r),r=Object.assign({title:"",prompt:"",selBgColor:f.Core.drawState.fgColor,selFgColor:f.Core.drawState.bgColor,border:!0,borderChar:f.CONFIG.BORDER_CHAR,center:!1,centerH:!1,centerV:!1,padding:1,selIndex:0,cancelable:!1,typewriter:!1},r),n=f.Core.drawState.cursorCol,i=f.Core.drawState.cursorRow,o=f.TextRenderer.measure(r.prompt),a=r.prompt?1:0,c=r.borderChar?1:0,s=0,u=t.length,t.forEach(function(e){s=Math.ceil(Math.max(s,f.TextRenderer.measure(e).cols))}),l=Math.ceil(Math.max(o.cols,s))+2*r.padding+2*c,l=Math.min(l,f.CONFIG.SCREEN_COLS),u=a*(o.rows+1)+u+2*r.padding+2*c,(r.centerH||r.center)&&(n=Math.round((f.CONFIG.SCREEN_COLS-l)/2)),(r.centerV||r.center)&&(i=Math.round((f.CONFIG.SCREEN_ROWS-u)/2)),f.Core.drawState.cursorCol=n,f.Core.drawState.cursorRow=i,r.border&&(f.TextRenderer.printBox(l,u,!0,r.borderChar),r.title)&&(u=" "+r.title+" ",f.Core.drawState.cursorCol=n+Math.round((l-u.length)/2),f.TextRenderer.print(u)),r.prompt){if(f.Core.drawState.cursorCol=o.cols<=l?n+c+r.padding:n+Math.round((l-o.cols)/2),f.Core.drawState.cursorRow=i+c+r.padding,r.typewriter)return e.next=26,f.Async.typewriter(r.prompt);e.next=28}else e.next=29;break;case 26:e.next=29;break;case 28:f.TextRenderer.print(r.prompt);case 29:d=r.selIndex;case 30:return f.Core.drawState.cursorRow=i+c+r.padding+a*(o.rows+1),f.Core.drawState.cursorCol=o.cols<=s?n+c+r.padding:n+Math.round((l-s)/2),g(t,d,r),e.next=36,f.Input.readKeyAsync();case 36:(h=e.sent).includes("ArrowUp")?(d=0<d?d-1:t.length-1,1<t.length&&f.Sfx.play(f.CONFIG.SFX.MENU_UP),e.next=54):e.next=42;break;case 42:h.includes("ArrowDown")?(d=(d+1)%t.length,1<t.length&&f.Sfx.play(f.CONFIG.SFX.MENU_DOWN),e.next=54):e.next=47;break;case 47:if(h.includes("Enter")||h.includes("ButtonA")||h.includes(" "))return f.Sfx.play(f.CONFIG.SFX.MENU_SELECT),e.abrupt("return",d);e.next=52;break;case 52:if((h.includes("Escape")||h.includes("ButtonB"))&&r.cancelable)return e.abrupt("return",-1);e.next=54;break;case 54:e.next=30;break;case 56:case"end":return e.stop()}},e)}));return function(e,t){return r.apply(this,arguments)}})();var g=function(e,t,r){for(var n=f.Core.drawState.bgColor,i=f.Core.drawState.fgColor,o=0;o<e.length;o++){var a=o===t;f.Core.setColor(a?r.selFgColor:i,a?r.selBgColor:n),f.TextRenderer.print(e[o]+"\n")}f.Core.setColor(i,n)}})(beep8||_readOnlyError("beep8")),(U=>{function B(e,t){for(var r=[],n=0;n<e;n++)r.push(t(n));return r}U.Music={};var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function i(e){var t,r,e=e.match(/^([A-Ga-g])([#b]?)(\d)$/);return e?(r=e[1].toUpperCase(),t=e[2],e=parseInt(e[3],10),r={C:0,D:2,E:4,F:5,G:7,A:9,B:11}[r],"#"===t?r+=1:"b"===t&&--r,12*(e+1)+r):null}function N(e){e=i(e);return null===e?"?":(e=U.Utilities.clamp(e,36,87),t.charAt(e-36))}function M(e){if(0===e.length)return"";for(var t=e[0],r=1;r<e.length;r++)e[r]===e[r-1]&&" "!==e[r]&&"|"!==e[r]?t+="-":t+=e[r];return t}function T(e,t,r,n){for(var i=B(e,function(){return!1}),o=0;o<n&&!(e<r);o++)i=((e,r,t)=>{for(var n=B(r,function(){return!1}),i=0;i<t;i++)n[U.Random.int(0,r-1)]=!0;return e.map(function(e,t){return n[t%r]?!e:e})})(i,r,t),r*=2;return i}var c=[["I","IIIm","VIm"],["IV","IIm"],["V","VIIm"]],s=[[0,1,2],[1,2,0],[2,0]],r={I:["C4","E4","G4","B4"],IIIm:["E4","G4","B4","D5"],VIm:["A3","C4","E4","G4"],IV:["F4","A4","C5","E5"],IIm:["D4","F4","A4","C5"],V:["G3","B3","D4","F4"],VIIm:["B3","D4","F4","A4"]},o={C:0,D:2,Eb:3,F:5,G:7,A:9,Bb:10},_=[0,1,2,3,4,5],D=[6,7];function l(e,t){var t=r[t]||r.I,n=o[e]||0;return t.map(function(e){var t=n,r=i(e);return null===r?e:(r+=t,e=Math.floor(r/12)-1,["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][r%12]+e)})}U.Music.generate=function(e){e&&e.seed&&U.Random.setSeed(e.seed);var t={seed:U.Random.int(1e4,99999),noteCount:U.Random.pick([16,32,48,64]),channelCount:U.Random.int(2,5),drumPartRatio:.3,tempo:U.Random.pick([70,100,140,170,200,240,280]),hold:U.Random.pick([40,50,60,60,70,70,70,80,80,80,80,90,90,90,100,110,120,130,140,150])},R=Object.assign({},t,e),k=(U.Music.currentSongProperties=R,U.Random.setSeed(R.seed),(e=>{for(var t,r=U.Random.pick(["C","D","Eb","F","G","A","Bb"]),n=null,i=0,o=[],a=0;a<e;a++)a%4==0&&(0===a?(i=U.Random.int(0,c.length-1),n=U.Random.pick(c[i])):U.Random.num()<.8-a/4%2*.5&&(i=U.Random.pick(s[i]),n=U.Random.pick(c[i])),t=l(r,n)),o.push(t);return o})(R.noteCount)),t=B(R.channelCount,function(){if(U.Random.num()<R.drumPartRatio){for(var e=R.noteCount,t=[U.Random.pick(D),"|"],r=T(e,U.Random.int(1,3),U.Random.pick([4,8]),3),n=N("C4"),i=0;i<e;i++)t.push(r[i]?n:" ");return t.push("|"),M(t)}if(U.Random.num()<.5){for(var o,a,c=R.noteCount,s=k,l=[U.Random.pick(_),"|"],u=T(c,4,8,3),d=U.Random.int(-1,1),h=0;h<c;h++)U.Random.chance(10)&&(d+=U.Random.int(-1,1)),u[h]?(a=(a=s[h])[U.Random.int(0,a.length-1)],o=parseInt(a.slice(-1),10),o=U.Utilities.clamp(o+d,3,6),a=N(a.slice(0,-1).toUpperCase()+o),l.push(a)):l.push(" ");return l.push("|"),M(l)}for(var f,g,p=R.noteCount,C=k,A=[U.Random.pick(_),"|"],m=U.Random.chance(30),w=U.Random.pick([4,8,16]),v=B(w,function(){return U.Random.int(0,3)}),y=U.Random.pick([2,4,8]),b=m?B(p,function(){return!0}):T(p,U.Random.pick([1,1,y/2]),y,2),E=U.Random.int(-1,1),I=U.Random.chance(m?30:80),S=0,x=0;x<p;x++)I&&x%y==0&&(S=(S+1)%2),b[x]?(g=C[x][m?v[x%w]:0],f=parseInt(g.slice(-1),10),f=U.Utilities.clamp(f+E+S,3,6),g=N(g.slice(0,-1).toUpperCase()+f),A.push(g)):A.push(" ");return A.push("|"),M(A)});return null!==R.tempo&&(e=String(R.tempo),null!==R.hold&&(e+="."+String(R.hold)),t[0]=e+"\n"+t[0]),t.join("\n")};var n=null;U.Music.play=function(e){p1(e),e&&(n=e)},U.Music.stop=function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];U.Utilities.checkBoolean("clearCurrentSong",e),e&&(n=null),U.Music.play("")},U.Music.pause=function(){U.Music.isPlaying()&&U.Music.stop(!1)},U.Music.resume=function(){n&&!U.Music.isPlaying()&&U.Music.play(n)},U.Music.setVolume=function(e){U.Utilities.checkNumber("volume",e),p1.setVolume(e)},U.Music.setTempo=function(e){U.Utilities.checkInt("tempo",e),e<50&&(e=50),p1.setTempo(e)},U.Music.isPlaying=function(){return p1.isPlaying()},document.addEventListener("beep8.pageVisibility.wake",U.Music.resume),document.addEventListener("beep8.pageVisibility.sleep",U.Music.pause)})(beep8),(t=>{var r=0,n=!1;function e(){n||(n=!0,r=Date.now(),t.Utilities.event("pageVisibility.sleep"))}function i(){var e;n&&(n=!1,0!==r)&&(e=Date.now()-r,t.Utilities.log("Time asleep:",(e/1e3).toFixed(3)),t.Utilities.event("pageVisibility.wake",{time:e}),r=0)}document.addEventListener("visibilitychange",function(){(document.hidden?e:i)()}),window.addEventListener("blur",e),window.addEventListener("focus",i)})(beep8||_readOnlyError("beep8")),(l=>{l.Particles={};var n=[];l.Particles.add=function(e,t,r){l.Utilities.checkNumber("x",e),l.Utilities.checkNumber("y",t),l.Utilities.checkObject("props",r);e=Object.assign({},{x:e,y:t,vx:0,vy:0,life:1,size:1,color:15,gravity:0},r);Array.isArray(e.color)&&(e.color=l.Random.pick(e.color)),Array.isArray(e.size)&&(e.size=l.Random.pick(e.size)),n.push(e)},l.Particles.createExplosion=function(e,t){for(var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=(l.Utilities.checkNumber("x",e),l.Utilities.checkNumber("y",t),l.Utilities.checkNumber("count",r),l.Utilities.checkObject("props",n),{size:1,color:l.Core.drawState.fgColor,life:2,speed:25,gravity:0}),o=Object.assign({},i,n),a=0;a<r;a++){var c=l.Random.range(0,2*Math.PI),s=l.Random.range(o.speed/2,o.speed);l.Particles.add(e,t,{size:o.size,color:o.color,life:o.life,vx:Math.cos(c)*s,vy:Math.sin(c)*s,g:o.gravity})}},l.Particles.update=function(e){for(var t=n.length-1;0<=t;t--){var r=n[t];r.vy+=r.g*e,r.x+=r.vx*e,r.y+=r.vy*e,r.life-=e,r.life<=0&&n.splice(t,1)}},l.Particles.render=function(){for(var e=0;e<n.length;e++){var t=n[e],r=t.size/2;l.Core.ctx.fillStyle=l.Core.getColorHex(t.color),l.Core.ctx.fillRect(Math.round(t.x-r),Math.round(t.y-r),Math.round(t.size),Math.round(t.size))}},l.Particles.clearAll=function(){n=[]},l.Particles.getParticles=function(){return _toConsumableArray(n)},l.Particles.setParticles=function(e){l.Utilities.checkArray("particles",e),n=e}})(beep8||_readOnlyError("beep8")),(o=>{o.Passcodes={},o.Passcodes.codeLength=4,o.Passcodes.getCode=function(e){o.Utilities.checkIsSet("id",e);e=(e=>{e=btoa(e);for(var t=0,r="",n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;for(var i=0;i<5;i++)t=(t<<5)-t+o.CONFIG.PASSKEY.charCodeAt(i%o.CONFIG.PASSKEY.length),r+=Math.abs(t).toString(36);return r})(e+o.CONFIG.PASSKEY);return(e=(e=e.replace(/[^a-zA-Z]/g,"")).toUpperCase()).substring(0,o.Passcodes.codeLength)},o.Passcodes.checkCode=function(e,t){return o.Utilities.checkIsSet("id",e),o.Utilities.checkString("code",t),o.Passcodes.getCode(e)===t},o.Passcodes.getId=function(e){for(o.Utilities.checkString("code",e),e=e.toUpperCase(),c=1;c<999;c++)if(o.Passcodes.checkCode(c,e))return c;return null},o.Passcodes.input=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,r,n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t="Enter code:").length+2+2,i=Math.round((o.CONFIG.SCREEN_COLS-n)/2),r=Math.round((o.CONFIG.SCREEN_ROWS-6)/2),o.Core.setCursorLocation(i,r),o.TextRenderer.printBox(n,6),o.Core.setCursorLocation(i+2,r+2),o.TextRenderer.print(t+"\n>"),e.next=11,o.Async.readLine("",o.Passcodes.codeLength);case 11:return n=e.sent,i=o.Passcodes.getId(n),e.abrupt("return",i);case 14:case"end":return e.stop()}},e)}))})(beep8||_readOnlyError("beep8")),(a=>{a.Random={};var r=null;a.Random.setSeed=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;"string"==typeof(e=null===e?Date.now():e)&&(e=e.split("").reduce(function(e,t){return e+t.charCodeAt(0)},0)),r=e=((e=(e^=e<<13)^e>>17)^e<<5)>>>0;for(var t=0;t<10;t++)a.Random.num()},a.Random.getSeed=function(){return r},a.Random.num=function(){var e=4294967296;return(r=(1664525*r+1013904223)%e)/e},a.Random.range=function(e,t){return a.Utilities.checkNumber("min",e),a.Utilities.checkNumber("max",t),e+a.Random.num()*(t-e)},a.Random.int=function(e,t){a.Utilities.checkInt("min",e),a.Utilities.checkInt("max",t),t<=e&&(r=t,t=e,e=r);var r=a.Random.range(e,t);return Math.round(r)},a.Random.pick=function(e){return a.Utilities.checkArray("array",e),e[a.Random.int(0,e.length-1)]},a.Random.pickWeighted=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.2,e=(a.Utilities.checkArray("array",e),a.Random.weightedArray(e,t));return a.Random.pick(e)},a.Random.shuffleArray=function(e){a.Utilities.checkArray("array",e),e=e.slice();for(var t=0;t<e.length;t++){var r=a.Random.int(0,e.length-1),n=e[t];e[t]=e[r],e[r]=n}return e},a.Random.chance=function(e){return a.Utilities.checkNumber("probability",e),a.Random.num()<e/100},a.Random.weightedArray=function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.2,r=(a.Utilities.checkArray("array",e),[]),n=0;n<e.length;n++)for(var i=10*Math.pow(t,n),o=0;o<i;o++)r.push(e[n]);return r},a.Random.setSeed()})(beep8||_readOnlyError("beep8")),(u=>{for(var t,n=!(u.Renderer={}),o=[],i=0,r=(u.Renderer.render=function(){var e,t,r;u.Core.crashed||(u.Core.realCtx.imageSmoothingEnabled=!1,(r=t=0)<i&&(e=i*u.CONFIG.CHR_WIDTH,t=Math.round(Math.random()*e-e/2),r=Math.round(Math.random()*e-e/2),t=u.Utilities.clamp(t,-6,6),r=u.Utilities.clamp(r,-6,6),i-=u.Core.deltaTime),u.Core.realCtx.clearRect(0,0,u.Core.realCanvas.width,u.Core.realCanvas.height),u.Core.realCtx.drawImage(u.Core.canvas,t,r,u.Core.realCanvas.width,u.Core.realCanvas.height),n=!1,u.CursorRenderer.draw(u.Core.realCtx),u.Renderer.applyCrtFilter())},u.Renderer.shakeScreen=function(e){return u.Utilities.checkNumber("duration",e),e<=0?(u.Utilities.warn("Screenshake duration must be positive. Currently: "+e),!1):(i=e,!0)},u.Renderer.markDirty=function(){n||(n=!0,setTimeout(u.Renderer.render,1))},u.Renderer.applyCrtFilter=function(){var e;u.CONFIG.CRT_ENABLE<=0||!u.CONFIG.CRT_VIGNETTE||(e=(t=u.Core.realCtx.getImageData(0,0,u.CONFIG.SCREEN_WIDTH,u.CONFIG.SCREEN_HEIGHT)).data,r(e),a(e),u.Core.realCtx.putImageData(t,0,0))},function(e){if(!u.CONFIG.CRT_VIGNETTE)return e;for(var t=u.CONFIG.SCREEN_WIDTH,r=t/2,n=u.CONFIG.SCREEN_HEIGHT/2,i=Math.sqrt(Math.pow(r,2)+Math.pow(n,2)),o=.8*i,a=.25/(i*(1-.8)),c=0;c<e.length;c+=4){var s=c/4%t,l=Math.floor(c/4/t),s=Math.sqrt(Math.pow(s-r,2)+Math.pow(l-n,2)),l=s<o?1:Math.max(0,1-(s-o)*a);e[c]*=l,e[c+1]*=l,e[c+2]*=l}}),a=function(e){for(var t=u.CONFIG.SCREEN_WIDTH,r=u.CONFIG.SCREEN_HEIGHT,n=0;n<r;n+=2)for(var i=0;i<t;i++){var o=f(i,n),a=d(e,o),c=0<i?d(e,f(i-1,n)):a,s=i<t-1?d(e,f(i+1,n)):a;h(e,o,l(a,c,s))}},l=function(e,t,r){var n=u.CONFIG.CRT_ENABLE,i=1-n;return{r:e[0]*i+(t[0]+r[0])/2*n*o[t[0]],g:e[1]*i+(t[1]+r[1])/2*n*o[t[1]],b:e[2]*i+(t[2]+r[2])/2*n*o[t[2]]}},d=function(e,t){return[e[t+1],e[t+2],e[t+3]]},h=function(e,t,r){e[t+1]=r.r,e[t+2]=r.g,e[t+3]=r.b},f=function(e,t){return t*u.CONFIG.SCREEN_WIDTH*4+4*e},e=0;e<256;e++)o[e]=.4*Math.pow(e/255,1/2.2)+1})(beep8||_readOnlyError("beep8")),(o=>{o.Scene={};var t=null,a={};o.Scene.add=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:30,n=(o.Utilities.checkString("name",e),null!==t&&o.Utilities.checkObject("gameObject",t),o.Utilities.checkInt("frameRate",r),t.init||null),i=t.update||null,t=t.render||null;a[e]={init:n,update:i,render:t,frameRate:r}},o.Scene.set=function(e){o.Utilities.checkString("name",e),a[e]||o.Utilities.fatal('Scene "'.concat(e,'" does not exist.')),o.Core.stopFrame(),t=e,o.Input&&"function"==typeof o.Input.onEndFrame&&o.Input.onEndFrame();e=a[e];e.init&&e.init(),(e.update||e.render)&&o.frame(e.render,e.update,e.frameRate)},o.Scene.pause=function(){o.frame(null)},o.Scene.resume=function(){var e;t&&((e=a[t]).update||e.render)&&o.frame(e.render||function(){},e.update||function(){},e.frameRate||30)},o.Scene.get=function(){return t},o.Scene.getAll=function(){return a}})(beep8||_readOnlyError("beep8")),(r=>{r.Sfx={},r.Sfx.library={"fx/action/drag":[,0,293.6648,.1,,,4,6,32,,,,,1,1.4,.1,,.7,.1],"fx/break/001":[2.1,,339,.02,.07,.09,4,.2,-7,,,,.05,1,,.1,.16,.45,.02,.03],"fx/break/002":[1.5,,157,.16,,0,,.35,-24,28,,,,.1,,.6,,.19,.01],"fx/break/003":[2,,180,.05,.03,.04,,2.42,.6,,,,,,,,.15,.39,.04],"fx/fight/dodge":[1.2,.3,150,.05,,.05,,,-1,,,,,4,,,,,.02],"fx/fight/hit":[5,,185,,,,3,1.6,-7,,,,,,,.2,.19,.1,,.38,985],"fx/robot/001":[1.13,,172,.04,.18,.09,,.06,-38,-2.6,-99,,,,35,,.08],"fx/robot/002":[1.42,,61,.01,.02,0,1,.21,,,816,.01,.05,,-40,,.05,.71,.11],"fx/robot/003":[.9,,164,.04,.03,.14,,.8,46,66,,,,,,,,.71,.08,,217],"fx/robot/004":[,.02,1638,,.05,.17,1,,,,490,.09,,,,.1,.05,.5,.03],"fx/sci-fi/radioactive":[1,0,130,.02,.9,.39,2,.8,,,,,.13,.2,,.1,,.93,.06,.28],"fx/sci-fi/robot":[1,0,847,.02,.3,.9,1,1.67,,,-294,.04,.13,,,,.1],"fx/sci-fi/teleport":[1,,85,.08,.1,.01,1,4,,-11,1,.07,,.1,101,,.05,.68,.4,.12,1],"fx/sci-fi/warp":[3,0,713,.16,.09,.24,,.6,-29,-16,,,.09,.5,,,.23,.75,.15,.48],"fx/sci-fi/beam":[1,0,662,.82,.11,.33,1,0,,-.2,,,,1.2,,.26,.01],"fx/sci-fi/hover":[2,0,262.63,.1,.12,.3,0,2.4,-.1,0,0,0,.24,0,0,.1,.05,.98,.07,.17,0],"fx/thud/001":[1.5,,90,,.01,.03,4,,,,,,,9,50,.2,,.2,.01],"fx/thud/002":[1,,129,.01,,.15,,,,,,,,5],"fx/machine/buzz":[1,0,130.8128,.1,.1,.34,3,1.88,,,,,,,,.1,,.5,.04],"fx/machine/hum":[1,0,63,,1,,1,1.5,,,,,,,,3.69,.08],"fx/machine/humm":[1,,110,.03,.25,.15,2,1.32,,,,,.07,,-.1,,.11,.77],"fx/machine/warp":[2,,128,,.12,.26,,4.7,,-1,-62,.06,.07,,52,,,.66,.08],"fx/noise/001":[1.27,,390,.01,.04,.02,4,.71,4.8,,,,,,,,.01,.6,.06],"fx/noise/002":[.4,,60,,.01,0,4,.55,62,89,-88,.06,,,173,.6,,,.05],"fx/noise/003":[.2,,523.2511,.1,3,3,4,0,,,2250,,.04,,10,.01,,.82,1,,30],"fx/random/tone":[2,.8,999,,,,1,2,,,,,1,,,.1,.2],"fx/swoosh/001":[1,,1500,.02,,.02,4,.68,5,,,,.01,.7,136,,,,,.11],"fx/swoosh/002":[1.2,,585,,.02,.16,4,.25,,,,,,,,,,.55,.03],"fx/swoosh/003":[.2,,836,.11,,0,4,.91,13,,,,.09,.1,-39,,,.06,.07],"fx/swoosh/004":[1.2,,9220,.01,,,,5,,,,,,9],"fx/swoosh/005":[1.5,0,150,.05,,.05,,1.3,,,,,,3],"fx/swoosh/006":[2,,12,,,.008,,1.2,23,-7,,,.05,.4,,,.15,.82,.03,.28],"fx/vehicle/engine":[1.2,0,25,.05,.3,.5,3,9,-.01,,,,,,13,.1,.2],"fx/vehicle/carhorn":[1.8,0,250,.02,.02,.2,2,2,,,,,.02,,,.02,.01,,,.1],"fx/vehicle/horn":[2,,688,.02,.01,.007,1,2.6,,,,,.01,,85,,.01,.85,.03,.11,-818],"fx/vehicle/truckhorn":[1.5,,1376,.02,.01,.007,1,2.6,,,,,.01,,85,,.01,.85,.8,.11,-818],"fx/vehicle/siren":[1.3,0,960,,1,.01,,.8,-.01,,-190,.5,,.05,,,1],"fx/vehicle/submarine":[1.2,0,1975,.08,.56,.02,,,-.4,,-322,.56,.41,,,,.25],"fx/vehicle/rocket":[1.5,0,941,.8,,.8,4,.74,-222,,,,,.8,,1],"game/coin/001":[1.2,0,1675,,.06,.24,1,1.82,,,837,.06],"game/coin/002":[1.2,0,523.2511,.01,.06,.3,1,1.82,,,837,.06],"game/coin/003":[.6,0,1874,,.01,.25,2,.76,,,622,.1],"game/coin/004":[1,0,277,.03,.04,.06,1,1.8,1,,140,.06,.04,,,.1,,.99,.03],"game/collect/001":[1.1,0,450,,.01,.13,,2.7,,-9.5,500,.08,,,,,,.89],"game/collect/002":[1.05,,10,.08,.07,.24,2,1.03,,,-374,.04,.09,,,,,.72,.15,.18],"game/die/001":[1.5,0,537,.02,.02,.22,1,1.59,-6.98,4.97],"game/die/002":[1,,321,.01,.06,.06,1,3.8,,-49,,,,.3,,,,.79,.09],"game/die/003":[1,0,344,.01,.02,.28,1,1.4,,,50,,,,.3,.2,.15,.6,.06],"game/die/004":[.5,0,43,.01,,1,2,,,,,,,,,.02,.01],"game/jump/001":[1,.1,75,.03,.08,.17,1,1.88,7.83,,,,,.4],"game/jump/002":[1.2,,311,.03,.05,.05,,2.2,,9,,,.02,,2.7,,,.97,.05,,101],"game/jump/003":[1.5,,65,.04,.1,.13,1,1.5,,-31,,,,.3,,,,.99,.03],"game/jump/004":[,0,500,,.01,.13,,.2,1.7,,-400],"game/jump/005":[1,,341,,.14,.23,1,1.01,.9,,-132,.03,,.1,,.1,,.52,.22],"game/jump/006":[.7,,1496,.09,.09,.01,3,.14,,,-870,,,,3.2,.2,,.31,.02],"game/powerup/001":[,,188,.03,.09,.12,1,2.4,,95,,,,,,,,.63,.08],"game/powerup/002":[.8,0,413,.03,.05,.05,,1.8,,19,177,.05,,,,,,.83,.02],"game/powerup/003":[.5,,643,,.1,.12,1,.1,,99,,,,,,,,.6,.02,,-732],"game/powerup/004":[1.18,,143,.05,.08,.06,,.09,25,4.1,,,,,,,.01,.52,.09],"game/powerup/005":[1,,18,.01,.01,.21,1,.49,9.9,,,,,,,,.04,.95,.02],"game/powerup/006":[.5,,426,.01,,.05,,2.54,49,,9,.1,,,,,,.46,.15],"game/powerup/007":[1,,158,.09,.18,.03,,2.53,11,-58,63,.02,.01,.5,,,,.16],"game/powerup/008":[1.2,0,539,0,.04,.29,1,1.92,,,567,.02,.02,,,,.04],"instrument/bass/001":[2,0,65,.01,.08,.2,,2.6,,,,,,.1,,,,.61,.02,,-1686],"instrument/bass/002":[2,0,73,.01,.08,.2,,2.6,,,,,,.1,,,,.61,.02,,-1686],"instrument/bass/003":[2,0,82,.01,.08,.2,,2.6,,,,,,.1,,,,.61,.02,,-1686],"instrument/bass/004":[2,0,87,.01,.08,.2,,2.6,,,,,,.1,,,,.61,.02,,-1686],"instrument/bass/005":[2,0,97,.01,.08,.2,,2.6,,,,,,.1,,,,.61,.02,,-1686],"instrument/bass/006":[2,0,110,.01,.08,.2,,2.6,,,,,,.1,,,,.61,.02,,-1686],"instrument/bass/007":[2,0,123,.01,.08,.2,,2.6,,,,,,.1,,,,.61,.02,,-1686],"instrument/bass/008":[2,0,130,.01,.08,.2,,2.6,,,,,,.1,,,,.61,.02,,-1686],"instrument/drum/001":[1.5,0,86,,,,,.7,,,,.5,,6.7,1,.05],"instrument/drum/002":[.7,0,270,,,.12,3,1.65,-2,,,,,4.5,,.02],"tone/beep/001":[2,0,130,,.1,,1,1.5,,,,,,,,.1,.01],"tone/beep/002":[2,0,146,,.1,,1,1.5,,,,,,,,.1,.01],"tone/beep/003":[2,0,164,,.1,,1,1.5,,,,,,,,.1,.01],"tone/beep/004":[2,0,174,,.1,,1,1.5,,,,,,,,.1,.01],"tone/beep/005":[2,0,195,,.1,,1,1.5,,,,,,,,.1,.01],"tone/beep/006":[2,0,220,,.1,,1,1.5,,,,,,,,.1,.01],"tone/beep/007":[2,0,246,,.1,,1,1.5,,,,,,,,.1,.01],"tone/beep/008":[2,0,261,,.1,,1,1.5,,,,,,,,.1,.01],"tone/bell/001":[2,0,999,,,,,1.5,,.3,-99,.1,1.63,,,.11,.22],"tone/bell/002":[,0,1600,.13,.52,.61,1,1.1,,,,,,.1,,.14],"tone/bell/random":[2,.1,999,,,,,1.5,,.3,-99,.1,1.63,,,.11,.22],"tone/blip/001":[5,0,130,.02,.03,.02,,2.8,,,,,,,,,,.7,.02],"tone/blip/002":[3,0,146,.02,.03,.02,,2.8,,,,,,,,,,.7,.02],"tone/blip/003":[3,0,164,.02,.03,.02,,2.8,,,,,,,,,,.7,.02],"tone/blip/004":[3,0,174,.02,.03,.02,,2.8,,,,,,,,,,.7,.02],"tone/blip/005":[3,0,195,.02,.03,.02,,2.8,,,,,,,,,,.7,.02],"tone/blip/006":[3,0,220,.02,.03,.02,,2.8,,,,,,,,,,.7,.02],"tone/blip/007":[3,0,246,.02,.03,.02,,2.8,,,,,,,,,,.7,.02],"tone/blip/008":[3,0,261,.02,.03,.02,,2.8,,,,,,,,,,.7,.02],"tone/bloop/001":[1,,110,.02,,.09,1,.61,,,556,.12,,,,.3,,,.02],"tone/bloop/002":[1,0,521.25,,.02,.03,2,0,,.1,700,.01,,,1,.1],"tone/bloop/003":[1.12,,73,,.02,.11,2,1.18,,-.1,,,,,,.3,,.55,.05,.23],"tone/bloop/004":[.5,,1368,.09,,0,,1.11,-76,9.1,-490,,,,,,,.56],"tone/bloop/005":[2.03,,413,,,.24,2,.12,,,,,.11,,317,.1,.13,,,.01],"tone/bloop/006":[,0,,.01,.02,.09,,.6,17,-3,,,.1,,,,,.76,.08],"tone/bloop/007":[.3,,10,.06,,0,2,2.3,,,621,,,,,,,,.21,.26],"tone/bloop/008":[1.5,.05,24,.01,.02,.01,1,3.9,-33,0,0,0,0,0,355,0,0,.65,0,0,0],"tone/bloop/009":[2,.05,226,0,.08,.13,0,3.1,0,0,0,0,0,0,0,.1,.02,.76,.04,0,105],"tone/bloop/010":[4,0,224,.02,.02,.08,1,1.7,-13.9,,,,,,6.7],"tone/bloop/011":[1,,283,.02,,.11,,.38,,,,,.07,,,.1,.08,.63,.02],"tone/bloop/012":[1,0,288,.05,.01,,,2,-10,,,,,,,,,.5,.1],"tone/bloop/013":[2,0,700,.01,,0,,,,,,,,,,,,.1,.01],"tone/bloop/014":[2.21,,107,.02,.04,.07,,2.22,2,.9,,,,.4,,.5,.15,.42,.04],"tone/bloop/015":[.6,0,2200,,,.04,3,2,,,800,.02,,4.8,,.01,.1],"tone/jingle/001":[1.4,,183,.07,.13,.34,,3.3,,,35,.06,.07,,,,.13,.95,.27,.11],"tone/jingle/002":[.8,,208,.02,.21,.13,3,.2,,,40,.06,.1,,,,,.91,.2,.27],"tone/jingle/003":[.9,,56,.15,.46,.08,,1.6,-2,,-137,.01,.06,,,,.09,.77,.37,.13],"tone/jingle/004":[.6,,269,.03,.17,.41,,.2,,1,239,.08,.04,,,,,.72,.19,.43,-720],"tone/jingle/005":[1.3,0,130.81,.32,.35,.5,3,5.2,0,1,50,0,.14,0,0,0,0,.37,.04,.24,0],"tone/jingle/006":[1,,525,.18,.28,.17,1,1.24,8.3,-9.7,-151,.03,.06,,,,,.93,.02,.14],"tone/jingle/007":[.6,,934,.12,.38,.93,1,.27,,.4,-434,.08,.2,.1,,.1,.17,.55,1,.46],"tone/jingle/008":[1.4,0,20,.04,,.6,,1.31,,,-990,.06,.17,,,.04,.07],"tone/jingle/009":[1.2,0,80,.3,.4,.7,2,.1,-.73,3.42,-430,.09,.17,,,,.19],"tone/jingle/010":[.5,,392,.06,.22,.5,1,1.85,-.1,-.9,61,.05,.07,,,.1,,.96,.12],"tone/jingle/011":[.5,,146,.04,.23,.46,,.56,,-3.7,658,.02,.15,.1,,,,.82,.13,.2],"tone/jingle/012":[1,,284,.08,.2,.25,1,3,,,50,.09,.06,,,,,.6,.28,.03,-1391],"tone/jingle/013":[1.5,,430,.02,.12,.5,,.89,,-3.6,-133,.07,.13,,,.1,,.83,.23,.26],"tone/jingle/014":[.4,,22,.08,.22,.02,1,.52,-4.2,-9.8,,,.14,,-18,.2,,,.05],"tone/jingle/015":[,,193,.04,.27,.42,1,1.71,2.8,4.9,,,.1,.2,,.1,,.55,.27,.47],"tone/jingle/016":[1.1,,250,.07,.24,.26,,2,,164,211,.07,.08,,,.1,,.75,.12,.09,115],"tone/jingle/017":[,,103,.04,.11,.43,1,.77,,,57,.19,.05,,,.1,,.68,.24],"ui/click/001":[1.5,0,900,,.01,0,1,,-10,,-31,.02,,,,,,1.2,,.16,-1448],"ui/click/002":[2.5,,783,,.03,.02,1,2,,,940,.03,,,,,.2,.6,,.06],"ui/click/003":[1.5,.01,300,,,.02,3,.22,,,-9,.2,,,,,,.5],"ui/click/004":[1,0,685,.01,.03,.17,1,1.4,,,,,,,,,,.63,.01,,420],"ui/click/005":[6,,205,,.02,0,,1.03,,,,,,,,,.12,.32],"weapon/explode/001":[1.5,0,333,.01,0,.9,4,1.9,,,,,,.5,,.6],"weapon/explode/002":[1.1,0,418,0,.02,.2,4,1.15,-8.5,,,,,.7,,.1],"weapon/explode/003":[1.2,0,82,.02,,.2,4,4,,,,,,.8,,.2,,.8,.09],"weapon/explode/004":[2,.2,72,.01,.01,.2,4,,,,,,,1,,.5,.1,.5,.02],"weapon/explode/005":[2,,1e3,.02,,.2,1,3,.1,,,,,1,-30,.5,,.5],"weapon/explode/006":[1,,485,.02,.2,.2,4,.11,-3,.1,,,.05,1.1,,.4,,.57,.5],"weapon/explode/007":[.8,,372,.02,.02,.5,4,2.29,.2,,,,,.6,,.6,,.7,.04,.19],"weapon/explode/008":[1.05,,591,.03,.13,.51,4,3.02,.6,.1,,,.04,1.6,,1,,.46,.13],"weapon/explode/009":[1.99,,770,.03,.19,.35,,.26,,,,,,2,-50,.1,.27,.48,.06],"weapon/explode/010":[1.5,,98,.08,.18,.02,2,2.47,36,.5,,,.04,.1,,.9,.44,,.04],"weapon/explode/011":[1,,400,,.03,.21,3,.85,.5,,,,,1.8,,.5,,.97,.05],"weapon/explode/012":[1,,485,.02,.07,.03,4,.11,-3,.1,,,.05,1.1,,.4,,.57,.09],"weapon/explode/013":[,,30,.09,.12,.35,4,3,4,,,,,1.3,,.6,,.36,.21],"weapon/lazer/001":[1.5,0,515,.05,.07,.09,1,2.8,,,302,.06,.1,,3.5,.1,.08,.75,.04],"weapon/lazer/002":[,0,925,.04,.3,.6,1,.3,,6.27,-184,.09,.17],"weapon/lazer/003":[1,,375,.01,.06,,2,2.3,18,-10,,,,,18,,,.56,.14],"weapon/lazer/004":[.5,,2e3,,.05,0,,1.11,-17,,197,.01,,.2,,,,,.16],"weapon/lazer/005":[.9,,752,.03,.01,.02,,1.4,,,-10,.01,,,3.4,,,.68,.03,,106],"weapon/lazer/006":[1.9,,221,.01,.05,.06,1,3.9,-2,,116,.05,,,,,,.65,.02,,452],"weapon/lazer/007":[1,,659,.01,.04,,1,.4,,-75,179,.06,,,.2,,,.57],"world/footstep/001":[1.1,.05,157,.03,.04,.04,4,4.9,78,-13,0,0,.07,0,0,0,0,.91,.02,.33,0],"world/footstep/002":[.1,1,300,.05,.1,.05,4,.2,-100,,-50,.07,,.5,,.4,,,,.05],"world/footstep/003":[3,,5,,.06,.01,2,2.25,-19,-79,409,.01,,,6.6,,.2,.57,,.8],"world/nature/frog":[.5,,160,.03,.03,.02,,1.52,-23,93,662,.02,,,,.1,,,.07,.01],"world/nature/dolphin":[.5,0,448,.01,.1,.3,3,.39,-.5,,,,,,.2,.1,.08],"world/nature/whale":[1.2,0,1306,.8,.08,.02,1,,,,,,.48,,-.1,.11,.25],"world/nature/mouse":[1.2,0,1e3,.02,,.01,2,,18,,475,.01,.01],"world/nature/small-dog":[1,,759,.01,,.01,1,.97,15,,,,,,3.1,,,.76,.04],"world/nature/tweet":[.7,,1305,,,.03,1,.75,,23,694,.01,,,3.9,,,,.01],"world/water/splash":[2,,94,.07,.1,.33,4,.6,1,,,,,.1,1,.1,.1,.45,.15],"world/water/wave":[1,0,40,.5,,1.5,,11,,,,,,199],"world/water/pop":[1,0,103,,.02,.06,,1.24,-18,4.4,,,,.7,,.1,,.95,.03],"world/weather/thunder":[1.2,0,471,,.09,.47,4,1.06,-6.7,,,,,.9,61,.1,,.82,.09,.13]},r.Sfx.play=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";e&&(r.Utilities.checkString("sfx",e),r.Sfx.library[e]||r.Utilities.fatal("SFX ".concat(e," not found.")),r.Sfx.playFromArray(r.Sfx.library[e]))},r.Sfx.playFromArray=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];r.Utilities.checkArray("sfxArray",e),zzfx.apply(void 0,_toConsumableArray(e))},r.Sfx.add=function(e,t){r.Utilities.checkString("sfxName",e),r.Utilities.checkArray("sfxArray",t),r.Sfx.library[e]=t},r.Sfx.get=function(){return Object.keys(r.Sfx.library)}})(beep8||_readOnlyError("beep8")),(n=>{n.State=n.State||{};var r="";function i(e){return new Proxy(e,{get:function(e,t){e=e[t];return"object"===_typeof(e)&&null!==e?i(e):e},set:function(e,t,r){return e[t]=r,n.Utilities.event("stateChange",{prop:t,value:r}),!0}})}document.addEventListener("beep8.initComplete",function(){r="beep8.".concat(n.Utilities.makeUrlPretty(n.CONFIG.NAME),".state")},{once:!0}),n.State.save=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r,t=n.Utilities.encodeData({time:Date.now(),data:n.data});localStorage.setItem(e,t),n.State.lastSave=Date.now()},n.State.load=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r,e=localStorage.getItem(e);e?((e=n.Utilities.decodeData(e)).data&&(n.data=i(e.data)),e.time&&(n.State.lastSave=e.time)):n.Utilities.log("No state found for the given key.")},n.State.init=function(e){n.data||(n.data=i({})),localStorage.getItem(r)&&n.State.load(),n.data=n.Utilities.deepMergeByIndex(e,n.data),n.Utilities.log("State initialized:",n.data)},n.State.clear=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r;n.Utilities.log("Clearing state..."),localStorage.removeItem(e),n.data=i({})},n.data=i({})})(beep8||_readOnlyError("beep8")),(d=>{d.TextRenderer={};var u=[],h=(d.TextRenderer.fonts_={},d.TextRenderer.curFont_=null,d.TextRenderer.curTiles_=null,d.TextRenderer.prepareCharMap=function(){for(var e=_toConsumableArray(d.CONFIG.CHRS),t=0;t<e.length;t++)u.push(e[t].charCodeAt(0))},d.TextRenderer.initAsync=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.Utilities.log("beep8.TextRenderer init."),e.next=3,d.TextRenderer.loadFontAsync("default-thin",d.CONFIG.FONT_DEFAULT,.5,1);case 3:return d.TextRenderer.curFont_=e.sent,e.next=6,d.TextRenderer.loadFontAsync("tiles",d.CONFIG.FONT_TILES);case 6:return d.TextRenderer.curTiles_=e.sent,e.next=9,d.TextRenderer.loadFontAsync("actors",d.CONFIG.FONT_ACTORS);case 9:d.TextRenderer.curActors_=e.sent,d.TextRenderer.prepareCharMap();case 11:case"end":return e.stop()}},e)})),d.TextRenderer.loadFontAsync=(()=>{var r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,r){var n,i,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=2<o.length&&void 0!==o[2]?o[2]:1,n=3<o.length&&void 0!==o[3]?o[3]:1,d.Utilities.checkString("fontName",t),d.Utilities.checkString("fontImageFile",r),i=new d.TextRendererFont(t,r,i,n),e.next=7,i.initAsync();case 7:return d.TextRenderer.fonts_[t]=i,e.abrupt("return",i);case 9:case"end":return e.stop()}},e)}));return function(e,t){return r.apply(this,arguments)}})(),d.TextRenderer.setFont=function(e){e=d.TextRenderer.getFontByName(e);e&&(d.TextRenderer.curFont_=e)},d.TextRenderer.getFont=function(){return d.TextRenderer.curFont_},d.TextRenderer.setTileFont=function(e){e=d.TextRenderer.getFontByName(e);e&&(d.TextRenderer.curTiles_=e)},d.TextRenderer.getFontByName=function(e){d.Utilities.checkString("fontName",e);var t=d.TextRenderer.fonts_[e];if(t)return t;d.Utilities.fatal("setFont(): font not found: ".concat(e))},d.TextRenderer.print=function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,n=(d.TextRenderer.printFont_=t||d.TextRenderer.curFont_,d.Utilities.checkString("text",e),d.Utilities.checkNumber("wrapWidth",r),null!==t&&d.Utilities.checkObject("font",t),e=d.TextRenderer.wrapText(e,r,t),d.Core.drawState.cursorCol),i=d.Core.drawState.cursorRow,o=(d.TextRenderer.origFgColor_=d.Core.drawState.fgColor,d.TextRenderer.origBgColor_=d.Core.drawState.bgColor,d.TextRenderer.origFont_=d.TextRenderer.printFont_,d.TextRenderer.printFont_.getCharColCount()),a=d.TextRenderer.printFont_.getCharRowCount(),c=n,s=0;s<e.length;s++){var s=f(e,s),l=e.charCodeAt(s);10===l?(n=c,i+=a):0<=(l=u.indexOf(l))&&(h(l,n,i,d.Core.drawState.fgColor,d.Core.drawState.bgColor,d.TextRenderer.printFont_),n+=o)}d.Core.drawState.cursorCol=n,d.Core.drawState.cursorRow=i,d.Core.drawState.fgColor=d.TextRenderer.origFgColor_,d.Core.drawState.bgColor=d.TextRenderer.origBgColor_,d.Renderer.markDirty()},d.TextRenderer.printTypewriter=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,i,o,a,c,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=1<s.length&&void 0!==s[1]?s[1]:-1,r=2<s.length&&void 0!==s[2]?s[2]:.05,n=3<s.length&&void 0!==s[3]?s[3]:null,d.Utilities.checkString("text",t),d.Utilities.checkNumber("wrapWidth",a),d.Utilities.checkNumber("delay",r),i=d.col(),o=d.row(),t=d.TextRenderer.wrapText(t,a),a=0;case 10:if(a<=t.length){if(d.CONFIG.PRINT_ESCAPE_START&&t.substring(a,a+d.CONFIG.PRINT_ESCAPE_START.length)===d.CONFIG.PRINT_ESCAPE_START&&0<=(c=t.indexOf(d.CONFIG.PRINT_ESCAPE_END,a+d.CONFIG.PRINT_ESCAPE_START.length))&&(a=c+d.CONFIG.PRINT_ESCAPE_END.length),c=t.charCodeAt(a),d.Core.setCursorLocation(i,o),d.TextRenderer.print(t.substring(0,a),n),32!==c)return e.next=18,d.Async.wait(r);e.next=18}else e.next=21;break;case 18:a++,e.next=10;break;case 21:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),d.TextRenderer.printCentered=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(d.TextRenderer.printFont_=r||d.TextRenderer.curFont_,d.Utilities.checkString("text",e),d.Utilities.checkNumber("width",t),e){var n=d.Core.drawState.cursorCol,i=d.TextRenderer.printFont_.getCharRowCount();""===(e=e.split("\n"))[e.length-1]&&e.pop();for(var o=0;o<e.length;o++){var a=d.TextRenderer.measure(e[o]).cols;d.Core.drawState.cursorCol=n+(t-a)/2,d.TextRenderer.print(e[o],r,t),d.Core.drawState.cursorRow+=i}d.Core.drawState.cursorCol=n}},d.TextRenderer.printRight=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(d.TextRenderer.printFont_=r||d.TextRenderer.curFont_,d.Utilities.checkString("text",e),d.Utilities.checkNumber("width",t),e){var n=d.Core.drawState.cursorCol,i=d.TextRenderer.printFont_.getCharRowCount();""===(e=(e=d.TextRenderer.wrapText(e,t)).split("\n"))[e.length-1]&&e.pop();for(var o=0;o<e.length;o++){var a=d.TextRenderer.measure(e[o]).cols;d.Core.drawState.cursorCol=n+t-a,d.TextRenderer.print(e[o],r,t),d.Core.drawState.cursorRow+=i}d.Core.drawState.cursorCol=n}},d.TextRenderer.printChar=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(void 0!==t&&!isNaN(t)||(t=1),d.Utilities.checkNumber("ch",e),d.Utilities.checkNumber("n",t),!(d.Core.drawState.cursorCol<0||d.Core.drawState.cursorRow<0||d.Core.drawState.cursorCol>=d.CONFIG.SCREEN_COLS||d.Core.drawState.cursorRow>=d.CONFIG.SCREEN_ROWS)){for(;0<t--;)h(e,d.Core.drawState.cursorCol,d.Core.drawState.cursorRow,d.Core.drawState.fgColor,d.Core.drawState.bgColor,r),d.Core.drawState.cursorCol++;d.Renderer.markDirty()}},d.TextRenderer.spr=function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;d.Utilities.checkNumber("ch",e),d.Utilities.checkNumber("x",t),d.Utilities.checkNumber("y",r),d.Utilities.checkInt("direction",i),null!==n&&d.Utilities.checkObject("font",n),s(e,t,r,d.Core.drawState.fgColor,d.Core.drawState.bgColor,n,i)},d.TextRenderer.drawText=function(e,t,r,n){d.Utilities.checkNumber("x",e),d.Utilities.checkNumber("y",t),d.Utilities.checkString("text",r),n&&d.Utilities.checkString("fontName",n);var i=e,o=n&&d.TextRenderer.fonts_[n]||d.TextRenderer.curFont_;if(o)for(var a=0;a<r.length;a++){var c=r.charCodeAt(a);10===c?(e=i,t+=o.getCharHeight()):(s(c,e,t,d.Core.drawState.fgColor,d.Core.drawState.bgColor,o),e+=o.getCharWidth())}else d.Utilities.warn("Requested font '".concat(n,"' not found: not drawing text."))},d.TextRenderer.measure=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(d.Utilities.checkString("text",e),t=t||d.TextRenderer.curFont_,""===e)return{cols:0,rows:0};for(var r=1,n=0,i=0,o=0;o<e.length;o++){o=f(e,o,!0);10===e.charCodeAt(o)?(r++,n=0):(++n,i=Math.max(i,n))}return{cols:i*=t.getCharColCount(),rows:r*=t.getCharRowCount()}},d.TextRenderer.printRect=function(e,t,r){d.Utilities.checkNumber("width",e),d.Utilities.checkNumber("height",t),d.Utilities.checkNumber("ch",r);for(var n=d.Core.drawState.cursorCol,i=d.Core.drawState.cursorRow,o=0;o<t;o++)d.Core.drawState.cursorCol=n,d.Core.drawState.cursorRow=i+o,d.TextRenderer.printChar(r,e);d.Core.drawState.cursorCol=n,d.Core.drawState.cursorRow=i},d.TextRenderer.printBox=function(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:d.CONFIG.BORDER_CHAR,i=(d.Utilities.checkNumber("width",e),d.Utilities.checkNumber("height",t),d.Utilities.checkBoolean("fill",r),d.Utilities.checkNumber("borderChar",n),d.TextRenderer.curTiles_.getColCount());d.TextRenderer.drawBox(e,t,r,{NW:n,NE:n+2,SW:n+i+i,SE:n+i+i+2,V:n+i,H:n+1})},d.TextRenderer.drawBox=function(e,t){for(var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=d.Core.drawState.cursorCol,o=d.Core.drawState.cursorRow,a=0;a<t;a++)d.Core.drawState.cursorCol=i,d.Core.drawState.cursorRow=o+a,0===a?(d.TextRenderer.printChar(n.NW),d.TextRenderer.printChar(n.H,e-2),d.TextRenderer.printChar(n.NE)):a===t-1?(d.TextRenderer.printChar(n.SW),d.TextRenderer.printChar(n.H,e-2),d.TextRenderer.printChar(n.SE)):(d.TextRenderer.printChar(n.V),d.Core.drawState.cursorCol=i+e-1,d.TextRenderer.printChar(n.V));r&&2<e&&2<t&&(d.Core.drawState.cursorCol=i+1,d.Core.drawState.cursorRow=o+1,d.TextRenderer.printRect(e-2,t-2,0)),d.Core.drawState.cursorCol=i,d.Core.drawState.cursorRow=o},d.TextRenderer.wrapText=function(e,t){(2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)||d.TextRenderer.curFont_;if(t<=0)return e;var r,n=[],i=_createForOfIteratorHelper(e.split("\n"));try{for(i.s();!(r=i.n()).done;){var o,a=r.value.split(" "),c="",s=_createForOfIteratorHelper(a);try{for(s.s();!(o=s.n()).done;){var l=o.value;t<d.TextRenderer.measure((c+l).trim()).cols&&(n.push(c.trim()),c=""),c+=l+" "}}catch(e){s.e(e)}finally{s.f()}n.push(c.trim())}}catch(e){i.e(e)}finally{i.f()}return n.join("\n")},function(e,t,r,n,i){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,a=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,t=Math.round(t*d.CONFIG.CHR_WIDTH),r=Math.round(r*d.CONFIG.CHR_HEIGHT);s(e,t,r,n,i,o,a)}),s=function(e,t,r,n,i){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,a=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,c=(o=o||d.TextRenderer.curTiles_).getColCount(),s=o.getCharWidth(),l=o.getCharHeight(),u=Math.floor(e/c),e=e%c;t=Math.round(t),r=Math.round(r),0<=i&&(d.Core.ctx.fillStyle=d.Core.getColorHex(i),d.Core.ctx.fillRect(t,r,s,l)),1===d.CONFIG.SCREEN_COLORS&&i===n||(0<a&&(d.Core.ctx.save(),d.Core.ctx.translate(t+((c=0!=(1&a))?s:0),r+((i=0!=(2&a))?l:0)),d.Core.ctx.scale(c?-1:1,i?-1:1),r=t=0),c=d.Utilities.clamp(n,0,d.CONFIG.COLORS.length-1),i=o.getImageForColor(c),d.Core.ctx.drawImage(i,e*s,u*l,s,l,t,r,s,l),0<a&&d.Core.ctx.restore(),d.Renderer.markDirty())},f=function(e,t){var r,n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=d.CONFIG.PRINT_ESCAPE_START,o=d.CONFIG.PRINT_ESCAPE_END;return!i||!o||e.substring(t,t+i.length)!=i?t:(r=e.indexOf(o,t+i.length),n||(n=e.substring(t+i.length,r),a(n)),r+o.length)},a=function(e){if(0<e.indexOf(",")){var t,r=_createForOfIteratorHelper(e.split(","));try{for(r.s();!(t=r.n()).done;)a(t.value)}catch(e){r.e(e)}finally{r.f()}}else if(""!==(e=e.trim())){var n=e[0].toLowerCase(),i=e.substring(1),o=+i;switch(n){case"f":case"c":d.Core.drawState.fgColor=""!==i?o:d.TextRenderer.origFgColor_;break;case"b":d.Core.drawState.bgColor=""!==i?o:d.TextRenderer.origBgColor_;break;case"t":d.TextRenderer.printFont_=d.TextRenderer.getFontByName(i);break;case"z":d.Core.drawState.fgColor=d.TextRenderer.origFgColor_,d.Core.drawState.bgColor=d.TextRenderer.origBgColor_,d.TextRenderer.printFont_=d.TextRenderer.origFont_||d.TextRenderer.fonts_.default;break;default:d.Utilities.warn("Unknown beep8 print escape command: "+e)}}};d.TextRenderer.regenColors=function(){Object.values(d.TextRenderer.fonts_).forEach(function(e){return e.regenColors()})}})(beep8||_readOnlyError("beep8")),(o=>{o.TextRendererFont=(()=>{return _createClass(function e(t,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;_classCallCheck(this,e),o.Utilities.checkString("fontName",t),o.Utilities.checkString("fontImageFile",r),this.fontName_=t,this.fontImageFile_=r,this.origImg_=null,this.chrImages_=[],this.imageWidth_=0,this.imageHeight_=0,this.colCount_=0,this.rowCount_=0,this.charWidth_=0,this.charHeight_=0,this.charColCount_=0,this.charRowCount_=0,this.tileWidthMultiplier_=n,this.tileHeightMultiplier_=i},[{key:"initAsync",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,r;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Utilities.loadImageAsync(this.fontImageFile_);case 2:return this.origImg_=e.sent,t=o.CONFIG.CHR_WIDTH*this.tileWidthMultiplier_,r=o.CONFIG.CHR_HEIGHT*this.tileHeightMultiplier_,o.Utilities.assert(this.origImg_.width%t==0&&this.origImg_.height%r==0,"Font ".concat(this.fontName_,": image ").concat(this.fontImageFile_," has dimensions ")+"".concat(this.origImg_.width,"x").concat(this.origImg_.height,".")),e.next=8,o.Utilities.makeColorTransparent(this.origImg_);case 8:return this.origImg_=e.sent,this.charWidth_=t,this.charHeight_=r,this.imageWidth_=this.origImg_.width,this.imageHeight_=this.origImg_.height,this.colCount_=this.imageWidth_/this.charWidth_,this.rowCount_=this.imageHeight_/this.charHeight_,this.charColCount_=this.tileWidthMultiplier_,this.charRowCount_=this.tileHeightMultiplier_,e.next=19,this.regenColors();case 19:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"getCharWidth",value:function(){return this.charWidth_}},{key:"getCharHeight",value:function(){return this.charHeight_}},{key:"getCharColCount",value:function(){return this.charColCount_}},{key:"getCharRowCount",value:function(){return this.charRowCount_}},{key:"getRowCount",value:function(){return this.rowCount_}},{key:"getColCount",value:function(){return this.colCount_}},{key:"getImageForColor",value:function(e){return this.chrImages_[e]}},{key:"regenColors",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,r,n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(this.chrImages_=[],t=0;t<o.CONFIG.COLORS.length;t++)(r=document.createElement("canvas")).width=this.origImg_.width,r.height=this.origImg_.height,(n=r.getContext("2d")).clearRect(0,0,this.origImg_.width,this.origImg_.height),n.globalCompositeOperation="source-over",n.drawImage(this.origImg_,0,0,this.origImg_.width,this.origImg_.height),n.globalCompositeOperation="source-in",n.fillStyle=o.CONFIG.COLORS[t],n.fillRect(0,0,this.origImg_.width,this.origImg_.height),2===o.CONFIG.SCREEN_COLORS&&(n.globalCompositeOperation="multiply",n.drawImage(this.origImg_,0,0,this.origImg_.width,this.origImg_.height)),this.chrImages_.push(r);case 2:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]);var e,t})()})(beep8||_readOnlyError("beep8")),(u=>{u.Tilemap={},u.Tilemap.MAP_CHAR=0,u.Tilemap.MAP_FG=1,u.Tilemap.MAP_BG=2,u.Tilemap.MAP_COLLISION=3,u.Tilemap.MAP_DATA=4;var i={solid:{0:1,1:1,2:1,3:36,4:1,5:1,6:18,7:1,8:1,9:37,10:1,11:1,12:19,13:1,14:1,15:1},rounded:{0:1,1:42,2:23,3:36,4:41,5:1,6:18,7:1,8:24,9:37,10:1,11:1,12:19,13:1,14:1,15:1},half:{0:128,1:75,2:58,3:93,4:75,5:75,6:57,7:129,8:58,9:95,10:58,11:111,12:59,13:130,14:112,15:113},half_rounded:{0:128,1:148,2:166,3:93,4:149,5:75,6:57,7:129,8:167,9:95,10:58,11:111,12:59,13:130,14:112,15:113},pipe:{0:128,1:148,2:166,3:93,4:149,5:[75,77],6:57,7:129,8:167,9:95,10:[58,94],11:111,12:59,13:130,14:112,15:[113,131,76]},thin:{0:110,1:173,2:172,3:164,4:154,5:72,6:146,7:126,8:155,9:165,10:55,11:108,12:147,13:127,14:109,15:73}};u.Tilemap.save=function(e){return u.Utilities.checkArray("tilemap",e),u.Utilities.encodeData(e)},u.Tilemap.load=function(e){return u.Utilities.checkString("data",e),u.Utilities.decodeData(e)},u.Tilemap.draw=function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,o=(u.Utilities.checkArray("tilemap",e),n=n||e[0].length,i=i||e.length,u.Utilities.checkInt("width",n),u.Utilities.checkInt("height",i),u.Core.drawState.cursorRow),a=u.Core.drawState.cursorCol,c=r;c<r+i;c++){u.locate(0+a,c-r+o);for(var s,l=t;l<t+n;l++)e[c]&&null!=e[c][l]&&(s=e[c][l])&&3<=s.length&&(u.color(s[u.Tilemap.MAP_FG],s[u.Tilemap.MAP_BG]),u.printChar(s[u.Tilemap.MAP_CHAR]))}},u.Tilemap.createEmptyTilemap=function(e,t){for(var r=[],n=0;n<t;n++){r[n]=[];for(var i=0;i<e;i++)r[n][i]=u.Tilemap.getDefaultTile()}return r},u.Tilemap.shift=function(e,t,r){u.Utilities.checkArray("tilemap",e),u.Utilities.checkNumber("dx",t),u.Utilities.checkNumber("dy",r);for(var n=e[0].length,i=e.length,o=u.Tilemap.createEmptyTilemap(n,i),a=0;a<i;a++)for(var c=0;c<n;c++)o[(a+r+i)%i][(c+t+n)%n]=_toConsumableArray(e[a][c]);return o},u.Tilemap.resize=function(e,t,r){u.Utilities.checkArray("tilemap",e),u.Utilities.checkNumber("width",t),u.Utilities.checkNumber("height",r);for(var n=u.Tilemap.createEmptyTilemap(t,r),i=0;i<r;i++)for(var o=0;o<t;o++)e[i]&&e[i][o]&&(n[i][o]=_toConsumableArray(e[i][o]));return n},u.Tilemap.getDefaultTile=function(){return[0,15,0,0,{}]},u.Tilemap.convertFromText=function(e){u.Utilities.checkString("text",e);e=e.split("\n").filter(function(e){return""!==e.trim()});return 0===e.length&&u.Utilities.fatal("No valid lines found in the map text."),e.map(function(e){return e.split("")})},u.Tilemap.createFromArray=function(e,t){for(var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=(u.Utilities.checkArray("grid",e),u.Utilities.checkObject("tilePattern",t),null!==r&&u.Utilities.checkObject("defaultTilePattern",r),null===r&&(r=u.Tilemap.getDefaultTile()),[]),i=0;i<e.length;i++){n[i]=[];for(var o,a,c,s,l=0;l<e[i].length;l++)n[i][l]=_toConsumableArray(r),t[e[i][l]]&&("string"==typeof(a=(o=t[e[i][l]]).t)&&a.startsWith("wall_")&&(a=u.Tilemap.wallTile(l,i,e,a)),Array.isArray(a)&&(a=u.Random.pickWeighted(a)),c=o.fg||15,Array.isArray(c)&&(c=u.Random.pickWeighted(c)),s=o.bg||0,Array.isArray(s)&&(s=u.Random.pickWeighted(s)),n[i][l]=[a,c,s,o.coll||0,o.data||{}])}return n},u.Tilemap.wallTile=function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,n=(u.Utilities.checkNumber("x",e),u.Utilities.checkNumber("y",t),u.Utilities.checkArray("grid",r),u.Utilities.checkString("name",n),null===n&&u.Utilities.fatal("Wall tile name not given: "+n),n.substring(5)),r=(i[n]||u.Utilities.fatal("Wall tile type not found: "+n),((e,t,r)=>{var n=0,i=e[r][t];return 0<r&&e[r-1][t]===i&&(n+=1),t<e[r].length-1&&e[r][t+1]===i&&(n+=2),r<e.length-1&&e[r+1][t]===i&&(n+=4),0<t&&e[r][t-1]===i&&(n+=8),n})(r,e,t));return i[n][r]}})(beep8||_readOnlyError("beep8")),(beep8||({},_readOnlyError("beep8"))).Timer={create:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:60;return{initialTime:e,currentTime:e,isRunning:1<arguments.length&&void 0!==arguments[1]&&arguments[1],isPaused:!1,format:"MM:SS",start:function(){this.isRunning=!0,this.isPaused=!1},stop:function(){this.isRunning=!1,this.currentTime=this.initialTime,this.isPaused=!1},pause:function(){this.isRunning&&(this.isPaused=!0)},resume:function(){this.isRunning&&this.isPaused&&(this.isPaused=!1)},reset:function(){this.currentTime=this.initialTime,this.isRunning=!1,this.isPaused=!1},addTime:function(e){this.currentTime+=e},removeTime:function(e){this.currentTime=Math.max(0,this.currentTime-e)},update:function(e){this.isRunning&&!this.isPaused&&(this.currentTime-=e,this.currentTime<=0)&&(this.currentTime=0,this.isRunning=!1)},setFormat:function(e){this.format=e},getFormattedTime:function(){var e,t,r,n=Math.floor(this.currentTime);return"SS"===this.format?this.currentTime.toFixed(1)+"s":"HH:MM:SS"===this.format?(r=Math.floor(n/3600),e=Math.floor(n%3600/60),t=n%60,r.toString().padStart(2,"0")+":"+e.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")):(r=n%60,Math.floor(n/60).toString().padStart(2,"0")+":"+r.toString().padStart(2,"0"))}}}},(l=>{l.Utilities={},l.Utilities.fatal=function(t){l.Utilities.error("Fatal error: "+t);try{l.Core.handleCrash(t)}catch(e){l.Utilities.error("Error in beep8.Core.handleCrash: "+e+" while handling error "+t)}throw new Error(t)},l.Utilities.assert=function(e,t){return e||l.Utilities.fatal(t||"Assertion Failed"),e},l.Utilities.assertDebug=function(e,t){return e||(l.CONFIG.DEBUG?warn("DEBUG ASSERT failed: "+t):l.Utilities.fatal(t)),e},l.Utilities.assertEquals=function(e,t,r){return e!==t&&l.Utilities.fatal("".concat(r,": expected ").concat(e," but got ").concat(t)),t},l.Utilities.checkType=function(e,t,r){return l.Utilities.assert(e,"checkType: varName must be provided."),l.Utilities.assert(r,"checkType: varType must be provided."),l.Utilities.assert(_typeof(t)===r,"".concat(e," should be of type ").concat(r," but was ").concat(_typeof(t),": ").concat(t)),t},l.Utilities.checkNumber=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0;return l.Utilities.checkType(e,t,"number"),isNaN(t)&&l.Utilities.fatal("".concat(e," should be a number but is NaN")),isFinite(t)||l.Utilities.fatal("".concat(e," should be a number but is infinite: ").concat(t)),void 0!==r&&l.Utilities.assert(r<=t,"".concat(e," should be >= ").concat(r," but is ").concat(t)),void 0!==n&&l.Utilities.assert(t<=n,"".concat(e," should be <= ").concat(n," but is ").concat(t)),t},l.Utilities.checkInt=function(e,t,r,n){return l.Utilities.checkNumber(e,t,r,n),t!==Math.round(t)&&l.Utilities.fatal("".concat(e," should be an integer but is ").concat(t)),t},l.Utilities.checkString=function(e,t){return l.Utilities.checkType(e,t,"string")},l.Utilities.checkBoolean=function(e,t){return l.Utilities.checkType(e,t,"boolean")},l.Utilities.checkFunction=function(e,t){return null===t&&l.Utilities.fatal("".concat(e," should be a function, but was null")),l.Utilities.checkType(e,t,"function")},l.Utilities.checkObject=function(e,t){return null===t&&l.Utilities.fatal("".concat(e," should be an object, but was null")),l.Utilities.checkType(e,t,"object")},l.Utilities.checkInstanceOf=function(e,t,r){return l.Utilities.assert(t instanceof r,"".concat(e," should be an instance of ").concat(r.name," but was not, it's: ").concat(t)),t},l.Utilities.checkIsSet=function(e,t){return l.Utilities.assert(null!=t,"".concat(e," should be set but was: ").concat(t)),t},l.Utilities.checkArray=function(e,t){return l.Utilities.assert(Array.isArray(t),"".concat(e," should be an array, but was: ").concat(t)),t},l.Utilities.log=function(e){l.CONFIG.DEBUG&&console.log(e)},l.Utilities.warn=function(e){console.warn(e)},l.Utilities.error=function(e){console.error(e)},l.Utilities.loadImageAsync=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(r){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){var t=new Image;t.src=r,t.onload=function(){return e(t)}}));case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),l.Utilities.makeColorTransparent=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,i,o,a,c,s,l,u,d,h=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r=1<h.length&&void 0!==h[1]?h[1]:[255,0,255],n=2<h.length&&void 0!==h[2]?h[2]:5,i=document.createElement("canvas"),o=i.getContext("2d"),i.width=t.width,i.height=t.height,o.drawImage(t,0,0),a=o.getImageData(0,0,i.width,i.height),c=a.data,s=0;s<c.length;s+=4)l=c[s],u=c[s+1],d=c[s+2],Math.abs(l-r[0])<=n&&Math.abs(u-r[1])<=n&&Math.abs(d-r[2])<=n&&(c[s+3]=0);return o.putImageData(a,0,0),e.abrupt("return",i);case 12:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),l.Utilities.loadFileAsync=function(n){return new Promise(function(e,t){var r=new XMLHttpRequest;r.addEventListener("load",function(){r.status<200||299<r.status?t("HTTP request finished with status "+r.status):e(r.responseText)}),r.addEventListener("error",function(e){return t(e)}),r.open("GET",n),r.send()})},l.Utilities.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},l.Utilities.dist2d=function(e,t,r,n){l.Utilities.checkNumber("x0",e),l.Utilities.checkNumber("y0",t),l.Utilities.checkNumber("x1",r),l.Utilities.checkNumber("y1",n);e-=r,r=t-n;return Math.sqrt(e*e+r*r)},l.Utilities.hexToRgb=function(e){e=e.replace("#","");e=parseInt(e,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},l.Utilities.intersectIntervals=function(e,t,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,e=(l.Utilities.checkNumber("as",e),l.Utilities.checkNumber("ae",t),l.Utilities.checkNumber("bs",r),l.Utilities.checkNumber("be",n),i&&l.Utilities.checkObject("result",i),Math.max(e,r)),r=Math.min(t,n);return e<=r&&(i&&(i.start=e,i.end=r),!0)},l.Utilities.intersectRects=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,a=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,c=(l.Utilities.checkObject("r1",e),l.Utilities.checkObject("r2",t),l.Utilities.checkNumber("r1.x",e.x),l.Utilities.checkNumber("r1.y",e.y),l.Utilities.checkNumber("r1.w",e.w),l.Utilities.checkNumber("r1.h",e.h),l.Utilities.checkNumber("r2.x",t.x),l.Utilities.checkNumber("r2.y",t.y),l.Utilities.checkNumber("r2.w",t.w),l.Utilities.checkNumber("r2.h",t.h),l.Utilities.checkNumber("dx1",r),l.Utilities.checkNumber("dx2",i),l.Utilities.checkNumber("dy1",n),l.Utilities.checkNumber("dy2",o),a&&checkObject("result",a),u),s=d;return!!l.Utilities.intersectIntervals(e.x+r,e.x+r+e.w-1,t.x+i,t.x+i+t.w-1,c)&&!!l.Utilities.intersectIntervals(e.y+n,e.y+n+e.h-1,t.y+o,t.y+o+t.h-1,s)&&(a&&(a.x=c.start,a.w=c.end-c.start+1,a.y=s.start,a.h=s.end-s.start+1),!0)};var u={},d={};l.Utilities.makeUrlPretty=function(e){l.Utilities.checkString("uglyStr",e);return e=(e=(e=(e=(e=e.toLowerCase()).replace(/[\s/]+/g,"-")).replace(/[^a-z0-9\-]+/g,"")).replace(/-+/g,"-")).replace(/^-+|-+$/g,"")},l.Utilities.deepMerge=function(){for(var o=function(e){return e&&"object"===_typeof(e)},e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(n,i){return Object.keys(i).forEach(function(e){var t=n[e],r=i[e];Array.isArray(t)&&Array.isArray(r)?n[e]=t.concat.apply(t,_toConsumableArray(r)):o(t)&&o(r)?n[e]=l.Utilities.deepMerge(t,r):n[e]=r}),n},{})},l.Utilities.deepMergeByIndex=function(){for(var o=function(e){return e&&"object"===_typeof(e)},e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(n,i){return Object.keys(i).forEach(function(e){var t=n[e],r=i[e];Array.isArray(t)&&Array.isArray(r)?n[e]=((e,t)=>{for(var r=0;r<t.length;r++)e[r]=t[r];return e})(t,r):o(t)&&o(r)?n[e]=l.Utilities.deepMergeByIndex(t,r):n[e]=r}),n},{})},l.Utilities.padWithZeros=function(e,t){return l.Utilities.checkNumber("number",e),l.Utilities.checkInt("length",t),e<0&&l.Utilities.fatal("padWithZeros does not support negative numbers"),e.toString().padStart(t,"0")},l.Utilities.event=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:document,e=(l.Utilities.checkString("eventName",e),l.Utilities.checkObject("detail",t),l.Utilities.checkObject("target",r),e="beep8.".concat(e),new CustomEvent(e,{detail:t}));r.dispatchEvent(e)},l.Utilities.repeatArray=function(e,t){return l.Utilities.checkArray("array",e),l.Utilities.checkInt("times",t,0),Array(t).fill().flatMap(function(){return e})},l.Utilities.downloadFile=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=(l.Utilities.checkString("filename",e),l.Utilities.checkString("src",t),document.createElement("a"));r.setAttribute("href",t),r.setAttribute("download",e),document.body.appendChild(r),r.click(),document.body.removeChild(r)},l.Utilities.encodeData=function(e){e=CBOR.encode(e);return btoa(String.fromCharCode.apply(null,new Uint8Array(e)))},l.Utilities.decodeData=function(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);e=r.buffer;return CBOR.decode(e)}})(beep8||_readOnlyError("beep8")),(n=>{n.Joystick={};var i=null;n.Joystick.setup=function(){n.Utilities.log("Setting up virtual joystick...");var e=document.createElement("style"),e=(e.setAttribute("type","text/css"),e.innerText="\n:root {\n\t--b8-vjoy-button-color: #333;\n\t--b8-vjoy-button-size: 14vw;\n\t--b8-vjoy-button-dpad-size: calc(var(--b8-vjoy-button-size) * 2);\n\t--b8-console-radius: 2rem;\n\t--b8-border-radius: calc(var(--b8-vjoy-button-dpad-size) / 5);\n}\n\n.vjoy-container,\n.vjoy-container * {\n\tbox-sizing: border-box;\n\tuser-select: none;\n\t-webkit-user-select: none;\n\t-webkit-touch-callout: none;\n\ttouch-action: none;\n}\n\n.vjoy-container {\n\tposition: relative;\n\twidth: 100%;\n\tpadding: 8vw 4vw 8vw 6vw;\n\tbackground: deeppink;\n\tborder-radius: 0 0 var(--b8-console-radius) var(--b8-console-radius);\n}\n\n.vjoy-options {\n\tborder-radius: 5rem;\n\tposition: absolute;\n\tdisplay: flex;\n\tgap: 2vw;\n\talign-items: center;\n\tpadding: 2vw;\n\tborder-radius: 2rem;\n\tbackground: inherit;\n\ttop: -4vw;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n}\n\n.vjoy-controls {\n\tdisplay: flex;\n\tgap: 5vw;\n\tjustify-content: space-between;\n\talign-items: center;\n}\n\n.vjoy-dpad {\n\taspect-ratio: 1;\n\tmax-width: 10rem;\n\twidth: var(--b8-vjoy-button-dpad-size);\n\tdisplay: grid;\n\tgrid-template-columns: 1fr 1fr;\n\tgrid-template-rows: 1fr 1fr;\n\tflex-wrap: wrap;\n\ttransform: rotate(45deg);\n\tborder-radius: var(--b8-border-radius);\n\tbackground:black;\n\tgap: 1px;\n\tborder: 2px solid black;\n}\n\n.vjoy-dpad button {\n\twidth: 100%;\n\theight: 100%;\n\tposition: relative;\n}\n.vjoy-dpad button span {\n\ttransform: rotate(-45deg);\n}\n.vjoy-dpad button:after {\n\tposition: absolute;\n\tcontent: '';\n\tdisplay: block;\n\twidth: 100%;\n\theight: 100%;\n\tbackground: rgba(0,0,0,0);\n\ttransform: rotate(-45deg);\n}\n\n#vjoy-button-up {\n\tborder-radius: var(--b8-border-radius) 0 0 0;\n}\n#vjoy-button-down {\n\tborder-radius: 0 0 var(--b8-border-radius) 0;\n}\n#vjoy-button-left {\n\tborder-radius: 0 0 0 var(--b8-border-radius);\n}\n#vjoy-button-right {\n\tborder-radius: 0 var(--b8-border-radius) 0 0;\n}\n\n#vjoy-button-up:after {\n\ttransform: rotate(-45deg) translateY(-30%) scale(1.1);\n}\n#vjoy-button-down:after {\n\ttransform: rotate(-45deg) translateY(30%) scale(1.1);\n}\n#vjoy-button-left:after {\n\ttransform: rotate(-45deg) translateX(-30%) scale(1.1);\n}\n#vjoy-button-right:after {\n\ttransform: rotate(-45deg) translateX(30%) scale(1.1);\n}\n\n.vjoy-buttons {\n\tdisplay: flex;\n\tgap: 2vw;\n\ttransform: rotate(-45deg);\n\tborder: 0.8vw solid rgba(0,0,0,0.2);\n\tborder-radius: calc( var(--b8-border-radius) + 1vw );\n\tpadding: 1vw;\n}\n\n.vjoy-buttons button {\n\twidth: var(--b8-vjoy-button-size);\n\tmax-width: 5rem;\n\tmax-height: 5rem;\n\theight: var(--b8-vjoy-button-size);\n\tborder-radius: var(--b8-border-radius);\n\ttouch-action: none;\n\tborder: 2px solid black;\n\tposition: relative;\n}\n\n.vjoy-buttons button:after {\n\tposition: absolute;\n\tcontent: '';\n\tdisplay: block;\n\twidth: 100%;\n\theight: 100%;\n\tbackground: rgba(0,0,0,0);\n\ttransform: scale(1.2);\n}\n\n.vjoy-buttons button span {\n\ttransform: rotate(45deg);\n}\n\n.vjoy-button {\n\tbackground: var(--b8-vjoy-button-color) !important;\n\tborder: none;\n\tfont-family: arial, sans-serif;\n\tfont-size: 12px;\n\tfont-weight: 600;\n\tcolor: #aaa !important;\n\tuser-select: none;\n\ttouch-callout: none;\n\t-webkit-user-select: none;\n\t-webkit-touch-callout: none;\n\ttext-shadow: 0 -2px 0 black;\n\tpadding: 0;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tletter-spacing: 0.1em;\n\ttext-transform: uppercase;\n}\n\n.vjoy-button:hover,\n.vjoy-button:focus,\n.vjoy-button:active {\n\tbackground: black;\n\toutline: none;\n}\n\n#vjoy-button-screenshot,\n#vjoy-button-ter {\n\twidth: calc(var(--b8-vjoy-button-size) * 1.4);\n\tpadding: 1vw;\n\tborder-radius: 1rem;\n}\n",document.body.appendChild(e),document.createElement("div"));e.className="vjoy-container",e.innerHTML="\n<div class=\"vjoy-options\">\n\t<button id='vjoy-button-ter' class='vjoy-button'>Start</button>\n\t<button id='vjoy-button-screenshot' class='vjoy-button'>Snap</button>\n</div>\n<div class=\"vjoy-controls\">\n\t<div class=\"vjoy-dpad\">\n\t<button id='vjoy-button-up' class='vjoy-button'><span>U</span></button>\n\t<button id='vjoy-button-right' class='vjoy-button'><span>R</span></button>\n\t<button id='vjoy-button-left' class='vjoy-button'><span>L</span></button>\n\t<button id='vjoy-button-down' class='vjoy-button'><span>D</span></button>\n\t</div>\n\t<div class=\"vjoy-buttons\">\n\t<button id='vjoy-button-pri' class='vjoy-button'><span>A</span></button>\n\t<button id='vjoy-button-sec' class='vjoy-button'><span>B</span></button>\n\t</div>\n</div>",n.Core.getBeepContainerEl().appendChild(e),setTimeout(n.Joystick.continueSetup,10)},n.Joystick.continueSetup=function(){n.Joystick.setUpButton("vjoy-button-up","ArrowUp"),n.Joystick.setUpButton("vjoy-button-down","ArrowDown"),n.Joystick.setUpButton("vjoy-button-left","ArrowLeft"),n.Joystick.setUpButton("vjoy-button-right","ArrowRight"),n.Joystick.setUpButton("vjoy-button-pri","ButtonA"),n.Joystick.setUpButton("vjoy-button-sec","ButtonB"),n.Joystick.setUpButton("vjoy-button-ter","Enter"),n.Joystick.setUpButton("vjoy-button-screenshot","0"),document.body.addEventListener("touchstart",function(e){return e.preventDefault()})},n.Joystick.setUpButton=function(e,t){var r=n.Utilities.assert(document.getElementById(e),"Could not find button ID "+e);null===t?r.style.display="none":(["pointerdown","pointerstart"].forEach(function(e){r.addEventListener(e,function(e){e.preventDefault(),n.Joystick.handleButtonEvent(t,!0,e)},{passive:!1})}),["pointerout","pointerup","pointerleave"].forEach(function(e){r.addEventListener(e,function(e){return n.Joystick.handleButtonEvent(t,!1,e)})}),r.addEventListener("pointermove",function(e){e.preventDefault()},{passive:!1}),r.addEventListener("contextmenu",function(e){return e.preventDefault()}))},n.Joystick.handleButtonEvent=function(e,t,r){r.key=e,i=i||{},t?(n.Input.onKeyDown(r),i[e]||(i[e]={},i[e].initialTimeout=setTimeout(function(){i[e].interval=setInterval(function(){n.Input.onKeyDown(r)},150)},150))):(i[e]&&(i[e].initialTimeout&&clearTimeout(i[e].initialTimeout),i[e].interval&&clearInterval(i[e].interval),delete i[e]),n.Input.onKeyUp(r)),r.preventDefault()}})(beep8||_readOnlyError("beep8")),((e,k)=>{var U=Math.pow(2,-24),i=Math.pow(2,32),p=Math.pow(2,53),t={encode:function(e){var a,c=new ArrayBuffer(256),s=new DataView(c),l=0;function u(e){for(var t=c.byteLength,r=l+e;t<r;)t*=2;if(t!==c.byteLength)for(var n=s,i=(c=new ArrayBuffer(t),s=new DataView(c),l+3>>2),o=0;o<i;++o)s.setUint32(4*o,n.getUint32(4*o));return a=e,s}function d(){l+=a}function h(e){d(u(1).setUint8(l,e))}function f(e){for(var t=u(e.length),r=0;r<e.length;++r)t.setUint8(l+r,e[r]);d()}function g(e,t){var r,n;t<24?h(e<<5|t):t<256?(h(e<<5|24),h(t)):t<65536?(h(e<<5|25),n=t,d(u(2).setUint16(l,n))):t<4294967296?(h(e<<5|26),n=t,d(u(4).setUint32(l,n))):(h(e<<5|27),e=((e=t)-(t=t%i))/i,(r=u(8)).setUint32(l,e),r.setUint32(l+4,t),d())}if(!function e(t){var r;if(!1===t)return h(244);if(!0===t)return h(245);if(null===t)return h(246);if(t===k)return h(247);switch(typeof t){case"number":if(Math.floor(t)===t){if(0<=t&&t<=p)return g(0,t);if(-p<=t&&t<0)return g(1,-(t+1))}return h(251),r=t,d(u(8).setFloat64(l,r));case"string":for(var n=[],i=0;i<t.length;++i){var o=t.charCodeAt(i);o<128?n.push(o):(o<2048?n.push(192|o>>6):(o<55296?n.push(224|o>>12):(o=(1023&o)<<10,o|=1023&t.charCodeAt(++i),n.push(240|(o+=65536)>>18),n.push(128|o>>12&63)),n.push(128|o>>6&63)),n.push(128|63&o))}return g(3,n.length),f(n);default:if(Array.isArray(t))for(g(4,a=t.length),i=0;i<a;++i)e(t[i]);else if(t instanceof Uint8Array)g(2,t.length),f(t);else{var a,c=Object.keys(t);for(g(5,a=c.length),i=0;i<a;++i){var s=c[i];e(s),e(t[s])}}}}(e),"slice"in c)return c.slice(0,l);for(var e=new ArrayBuffer(l),t=new DataView(e),r=0;r<l;++r)t.setUint8(r,s.getUint8(r));return e},decode:function(t,C,A){var m=new DataView(t),w=0;function v(e,t){return w+=t,e}function y(e){return v(new Uint8Array(t,w,e),e)}function b(){return v(m.getUint8(w),1)}function E(){return v(m.getUint16(w),2)}function r(){return v(m.getUint32(w),4)}function I(){return 255===m.getUint8(w)&&(w+=1,1)}function S(e){if(e<24)return e;if(24===e)return b();if(25===e)return E();if(26===e)return r();if(27===e)return r()*i+r();if(31===e)return-1;throw"Invalid length encoding"}function x(e){var t=b();if(255===t)return-1;var r=S(31&t);if(r<0||t>>5!==e)throw"Invalid indefinite length element";return r}function R(e,t){for(var r=0;r<t;++r){var n=b();128&n&&(n<224?(n=(31&n)<<6|63&b(),--t):n<240?(n=(15&n)<<12|(63&b())<<6|63&b(),t-=2):(n=(15&n)<<18|(63&b())<<12|(63&b())<<6|63&b(),t-=3)),n<65536?e.push(n):(n-=65536,e.push(55296|n>>10),e.push(56320|1023&n))}}"function"!=typeof C&&(C=function(e){return e}),"function"!=typeof A&&(A=function(){return k});var e=function e(){var t,r,n=b(),i=n>>5,n=31&n;if(7==i)switch(n){case 25:var o=new ArrayBuffer(4),o=new DataView(o),a=E(),c=31744&a,s=1023&a;if(31744===c)c=261120;else if(0!==c)c+=114688;else if(0!=s)return s*U;return o.setUint32(0,(32768&a)<<16|c<<13|s<<13),o.getFloat32(0);case 26:return v(m.getFloat32(w),4);case 27:return v(m.getFloat64(w),8)}if((t=S(n))<0&&(i<2||6<i))throw"Invalid length";switch(i){case 0:return t;case 1:return-1-t;case 2:if(t<0){for(var l=[],u=0;0<=(t=x(i));)u+=t,l.push(y(t));for(var d=new Uint8Array(u),h=0,f=0;f<l.length;++f)d.set(l[f],h),h+=l[f].length;return d}return y(t);case 3:var g=[];if(t<0)for(;0<=(t=x(i));)R(g,t);else R(g,t);return String.fromCharCode.apply(null,g);case 4:if(t<0)for(r=[];!I();)r.push(e());else for(r=new Array(t),f=0;f<t;++f)r[f]=e();return r;case 5:var p={};for(f=0;f<t||t<0&&!I();++f)p[e()]=e();return p;case 6:return C(e(),t);case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return k;default:return A(t)}}}();if(w!==t.byteLength)throw"Remaining bytes";return e}};"function"==typeof define&&define.amd?define("cbor/cbor",t):e.CBOR||(e.CBOR=t)})(this),(()=>{let h=new AudioContext,o=h.createGain();o.gain.value=1,o.connect(h.destination);const f={};let t=null,g=[],s=[],p=0,C=125,e=.5,r=50,u=!1,n=(e,t)=>Math.sin(6.28*e+t),A=[e=>.1*n(e,Math.pow(n(e,0),2)+.75*n(e,.25)+.1*n(e,.5)),e=>Math.sin(6.28*e)*Math.sin(3.14*e)*.1,e=>.1*Math.sin(2*Math.PI*e),e=>.1*(2*(e-Math.floor(e))-1),e=>.1*(0<=Math.sin(2*Math.PI*e)?1:-1),e=>{e-=Math.floor(e);return.1*(2*Math.abs(2*e-1)-1)},e=>(2*Math.random()-1)*Math.exp(-e/10)*.1,e=>(Math.sin(2*e)+.3*(Math.random()-.5))*Math.exp(-e/15)*.1*2];function i(e){if((e=Array.isArray(e)?e[0]:e)&&""!==e.trim()){200<f.length&&(console.warn("Beep8.Music: Note buffers exceeded limit, clearing old buffers."),f={}),C=125;let l=.5;g=[];e=e.split("\n").map(e=>e.trim());let u=C/1e3,d=/^([0-9])\|(.*)\|$/;e.forEach(e=>{if(e)if(e.startsWith("[")&&e.endsWith("]")||/^\d+(\.\d+)?$/.test(e))t=e.replace(/[\[\]]/g,"").split("."),C=parseFloat(t[0])||C,l=(parseFloat(t[1])||50)/100,u=C/1e3;else if(d.test(e)){var t=e.match(d),r=parseInt(t[1],10),n=A[r]||A[0],i=t[2].trim(),o=[];for(let t=0;t<i.length;t++){var a=i[t];let e=1;for(;t+e<i.length&&"-"===i[t+e];)e++;var c,s=t*u;" "===a?(o.push({startTime:s,noteBuffer:null}),t+=e-1):(a=a.charCodeAt(0),c=(a-=90<a?71:65,e*l*(C/125)),a=m(a,c,44100,n),o.push({startTime:s,noteBuffer:a}),t+=e-1)}g.push(o)}else console.error("Track lines must be in the format 'instrument|track data|': "+e)}),s=g.map(()=>0),p=h.currentTime+.1,i.stop(),t=setInterval(a,r)}else i.stop()}function a(){let o=h.currentTime,a=C/1e3,c=Math.max(e,a);g.forEach((e,t)=>{var r,n=s[t],i=e.length;0!==i&&(r=n%i,n=Math.floor(n/i),(n=p+r*a+n*i*a)<o+c)&&((i=e[r]).noteBuffer&&d(i.noteBuffer,h,n),s[t]++)}),i.loop||g.every((e,t)=>s[t]>=e.length)&&i.stop()}i.stop=function(){null!==t&&(clearInterval(t),t=null),c.forEach(e=>e.stop()),c=[]},i.isPlaying=function(){return null!==t},i.setTempo=function(e){e<50&&(e=50);var t=C/1e3,r=e/1e3,t=(h.currentTime-p)/t;p=h.currentTime-t*r,C=e},i.setVolume=function(e){o.gain.value=Math.min(1,Math.max(0,e))},i.clearCache=function(){f={}},i.loop=!0;let m=(e,t,r,n)=>{var i=e+"-"+t+"-"+n.name;let o=f[i];if(0<=e&&!o){var a=65.406*Math.pow(1.06,e)/r,c=Math.floor(r*t),s=r*(t-.002),l=(o=f[i]=h.createBuffer(1,c,r)).getChannelData(0);for(let t=0;t<c;t++){let e;e=t<88?t/88.2:Math.pow(1-(t-88)/s,Math.pow(Math.log(1e4*a)/2,2)),l[t]=e*n(t*a)}u||(d(o,h,h.currentTime,!0),u=!0)}return o},c=[],d=(e,t,r,n=!1)=>{let i=t.createBufferSource();i.buffer=e,i.connect(o),i.start(r),c.push(i),n&&i.stop(),i.onended=()=>{var e=c.indexOf(i);-1!==e&&c.splice(e,1)}};window.p1=i})();let zzfx=(...e)=>zzfxP(zzfxG(...e)),zzfxV=.3,zzfxR=44100,zzfxX=new AudioContext,zzfxP=(...e)=>{let r=zzfxX.createBuffer(e.length,e[0].length,zzfxR),t=zzfxX.createBufferSource();return e.map((e,t)=>r.getChannelData(t).set(e)),t.buffer=r,t.connect(zzfxX.destination),t.start(),t},zzfxG=(e=1,t=.05,r=220,n=0,i=0,o=.1,a=0,O=1,c=0,s=0,l=0,u=0,d=0,F=0,h=0,G=0,f=0,g=1,p=0,C=0,A=0)=>{let m=2*Math.PI,w=e=>e<0?-1:1,Q=c*=500*m/zzfxR/zzfxR,v=r*=(1+2*t*Math.random()-t)*m/zzfxR,y=[],b=0,L=0,E=0,I=1,P=0,j=0,S=0,x,R,k=m*Math.abs(A)*2/zzfxR,U=Math.cos(k),B=Math.sin(k)/2/2,N=1+B,H=-2*U/N,W=(1-B)/N,M=(1+w(A)*U)/2/N,Y=-(w(A)+U)/N,z=M,T=0,_=0,D=0,V=0;for(n=n*zzfxR+9,p*=zzfxR,i*=zzfxR,o*=zzfxR,f*=zzfxR,s*=500*m/zzfxR**3,h*=m/zzfxR,l*=m/zzfxR,u*=zzfxR,d=d*zzfxR|0,e*=zzfxV,R=n+p+i+o+f|0;E<R;y[E++]=S*e)++j%(100*G|0)||(S=a?1<a?2<a?3<a?Math.sin(b**3):Math.max(Math.min(Math.tan(b),1),-1):1-(2*b/m%2+2)%2:1-4*Math.abs(Math.round(b/m)-b/m):Math.sin(b),S=(d?1-C+C*Math.sin(m*E/d):1)*w(S)*Math.abs(S)**O*(E<n?E/n:E<n+p?1-(E-n)/p*(1-g):E<n+p+i?g:E<R-f?(R-E-f)/o*g:0),S=f?S/2+(f>E?0:(E<R-f?1:(R-E)/f)*y[E-f|0]/2/e):S,A&&(S=V=z*T+Y*(T=_)+M*(_=S)-W*D-H*(D=V))),x=(r+=c+=s)*Math.cos(h*L++),b+=x+x*F*Math.sin(E**5),I&&++I>u&&(r+=l,v+=l,I=0),!d||++P%d||(r=v,c=Q,I=I||1);return y};